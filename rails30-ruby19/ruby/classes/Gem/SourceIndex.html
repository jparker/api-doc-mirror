<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Gem::SourceIndex</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Gem::SourceIndex 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rubygems/source_index_rb.html">lib/rubygems/source_index.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
The <a href="SourceIndex.html">SourceIndex</a> object indexes all the gems
available from a particular source (e.g. a list of gem directories, or a
remote source). <a href="../A.html">A</a> <a
href="SourceIndex.html">SourceIndex</a> maps a gem full name to a gem
specification.
</p>
<table>
<tr><td valign="top">NOTE:</td><td>The class used to be named Cache, but that became confusing when cached
source fetchers where introduced. The constant Gem::Cache is an alias for
this class to allow old YAMLized source index objects to load properly.

</td></tr>
</table>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M005847">add_spec</a>,</li>
                
                <li><a href="#M005848">add_specs</a>,</li>
                
                <li><a href="#M005840">all_gems</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M005862">dump</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M005850">each</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M005865">fetch_bulk_index</a>,</li>
                
                <li><a href="#M005864">fetch_index_from</a>,</li>
                
                <li><a href="#M005866">fetch_quick_index</a>,</li>
                
                <li><a href="#M005870">fetch_single_spec</a>,</li>
                
                <li><a href="#M005863">fetcher</a>,</li>
                
                <li><a href="#M005867">find_missing</a>,</li>
                
                <li><a href="#M005856">find_name</a>,</li>
                
                <li><a href="#M005837">from_gems_in</a>,</li>
                
                <li><a href="#M005835">from_installed_gems</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M005853">gem_signature</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M005852">index_signature</a>,</li>
                
                <li><a href="#M005836">installed_spec_directories</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M005844">latest_specs</a>,</li>
                
                <li><a href="#M005855">length</a>,</li>
                
                <li><a href="#M005843">load_gems_in</a>,</li>
                
                <li><a href="#M005838">load_specification</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M005839">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M005859">outdated</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M005841">prerelease_gems</a>,</li>
                
                <li><a href="#M005845">prerelease_specs</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M005858">refresh!</a>,</li>
                
                <li><a href="#M005842">released_gems</a>,</li>
                
                <li><a href="#M005846">released_specs</a>,</li>
                
                <li><a href="#M005868">remove_extra</a>,</li>
                
                <li><a href="#M005849">remove_spec</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M005857">search</a>,</li>
                
                <li><a href="#M005854">size</a>,</li>
                
                <li><a href="#M005851">specification</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M005869">unzip</a>,</li>
                
                <li><a href="#M005860">update</a>,</li>
                
                <li><a href="#M005871">update_with_missing</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../Kernel.html">Kernel</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="../Kernel.html">Kernel</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="../Kernel.html">Kernel</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>spec_dirs</td>
            <td class='attr-desc'><p>
Directories to use to refresh this <a
href="SourceIndex.html">SourceIndex</a> when calling refresh!
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M005837">
                    
                    <a name="M005837"></a><b>from_gems_in</b>(*spec_dirs)
                    
                </div>
                
                <div class="description">
                  <p>
Creates a new <a href="SourceIndex.html">SourceIndex</a> from the ruby
format gem specifications in <tt><a
href="SourceIndex.html#spec_dirs">spec_dirs</a></tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005837_source')" id="l_M005837_source">show</a>
                        
                    </p>
                    <div id="M005837_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 75</span>
75:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_gems_in</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">spec_dirs</span>)
76:       <span class="ruby-identifier">source_index</span> = <span class="ruby-identifier">new</span>
77:       <span class="ruby-identifier">source_index</span>.<span class="ruby-identifier">spec_dirs</span> = <span class="ruby-identifier">spec_dirs</span>
78:       <span class="ruby-identifier">source_index</span>.<span class="ruby-identifier">refresh!</span>
79:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005835">
                    
                    <a name="M005835"></a><b>from_installed_gems</b>(*deprecated)
                    
                </div>
                
                <div class="description">
                  <p>
Factory method to construct a source index instance for a given path.
</p>
<table>
<tr><td valign="top">deprecated:</td><td>If supplied, <a href="SourceIndex.html#M005835">from_installed_gems</a>
will act just like <tt><a
href="SourceIndex.html#M005837">from_gems_in</a></tt>. This argument is
deprecated and is provided just for backwards compatibility, and should not
generally be used.

</td></tr>
<tr><td valign="top">return:</td><td><a href="SourceIndex.html">SourceIndex</a> instance

</td></tr>
</table>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005835_source')" id="l_M005835_source">show</a>
                        
                    </p>
                    <div id="M005835_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 56</span>
56:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_installed_gems</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">deprecated</span>)
57:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">deprecated</span>.<span class="ruby-identifier">empty?</span>
58:         <span class="ruby-identifier">from_gems_in</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">installed_spec_directories</span>)
59:       <span class="ruby-keyword kw">else</span>
60:         <span class="ruby-identifier">from_gems_in</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">deprecated</span>) <span class="ruby-comment cmt"># HACK warn</span>
61:       <span class="ruby-keyword kw">end</span>
62:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005836">
                    
                    <a name="M005836"></a><b>installed_spec_directories</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns a list of directories from <a
href="../Gem.html#M004611">Gem.path</a> that contain specifications.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005836_source')" id="l_M005836_source">show</a>
                        
                    </p>
                    <div id="M005836_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 67</span>
67:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">installed_spec_directories</span>
68:       <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-value str">&quot;specifications&quot;</span>) }
69:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005838">
                    
                    <a name="M005838"></a><b>load_specification</b>(file_name)
                    
                </div>
                
                <div class="description">
                  <p>
Loads a ruby-format specification from <tt>file_name</tt> and returns the
loaded spec.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005838_source')" id="l_M005838_source">show</a>
                        
                    </p>
                    <div id="M005838_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 85</span>
 85:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_specification</span>(<span class="ruby-identifier">file_name</span>)
 86:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">file_name</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">file_name</span>
 87: 
 88:       <span class="ruby-identifier">spec_code</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-constant">Encoding</span> <span class="ruby-keyword kw">then</span>
 89:                     <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">:encoding</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'UTF-8'</span>
 90:                   <span class="ruby-keyword kw">else</span>
 91:                     <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span> <span class="ruby-identifier">file_name</span>
 92:                   <span class="ruby-keyword kw">end</span>.<span class="ruby-identifier">untaint</span>
 93: 
 94:       <span class="ruby-keyword kw">begin</span>
 95:         <span class="ruby-identifier">gemspec</span> = <span class="ruby-identifier">eval</span> <span class="ruby-identifier">spec_code</span>, <span class="ruby-identifier">binding</span>, <span class="ruby-identifier">file_name</span>
 96: 
 97:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gemspec</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>)
 98:           <span class="ruby-identifier">gemspec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">file_name</span>
 99:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">gemspec</span>
100:         <span class="ruby-keyword kw">end</span>
101:         <span class="ruby-identifier">alert_warning</span> <span class="ruby-node">&quot;File '#{file_name}' does not evaluate to a gem specification&quot;</span>
102:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SignalException</span>, <span class="ruby-constant">SystemExit</span>
103:         <span class="ruby-identifier">raise</span>
104:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SyntaxError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
105:         <span class="ruby-identifier">alert_warning</span> <span class="ruby-identifier">e</span>
106:         <span class="ruby-identifier">alert_warning</span> <span class="ruby-identifier">spec_code</span>
107:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
108:         <span class="ruby-identifier">alert_warning</span> <span class="ruby-node">&quot;#{e.inspect}\n#{spec_code}&quot;</span>
109:         <span class="ruby-identifier">alert_warning</span> <span class="ruby-node">&quot;Invalid .gemspec format in '#{file_name}'&quot;</span>
110:       <span class="ruby-keyword kw">end</span>
111: 
112:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
113:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005839">
                    
                    <a name="M005839"></a><b>new</b>(specifications={})
                    
                </div>
                
                <div class="description">
                  <p>
Constructs a source index instance from the provided specifications, which
is a <a href="../Hash.html">Hash</a> of gem full names and
Gem::Specifications.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005839_source')" id="l_M005839_source">show</a>
                        
                    </p>
                    <div id="M005839_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">specifications</span>={})
125:     <span class="ruby-ivar">@gems</span> = {}
126:     <span class="ruby-identifier">specifications</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">spec</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">spec</span> }
127:     <span class="ruby-ivar">@spec_dirs</span> = <span class="ruby-keyword kw">nil</span>
128:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M005847">
                    
                    <a name="M005847"></a><b>add_spec</b>(gem_spec, name = gem_spec.full_name)
                    
                </div>
                
                <div class="description">
                  <p>
Add a gem specification to the source index.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005847_source')" id="l_M005847_source">show</a>
                        
                    </p>
                    <div id="M005847_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 215</span>
215:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_spec</span>(<span class="ruby-identifier">gem_spec</span>, <span class="ruby-identifier">name</span> = <span class="ruby-identifier">gem_spec</span>.<span class="ruby-identifier">full_name</span>)
216:     <span class="ruby-comment cmt"># No idea why, but the Indexer wants to insert them using original_name</span>
217:     <span class="ruby-comment cmt"># instead of full_name. So we make it an optional arg.</span>
218:     <span class="ruby-ivar">@gems</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">gem_spec</span>
219:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005848">
                    
                    <a name="M005848"></a><b>add_specs</b>(*gem_specs)
                    
                </div>
                
                <div class="description">
                  <p>
Add gem specifications to the source index.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005848_source')" id="l_M005848_source">show</a>
                        
                    </p>
                    <div id="M005848_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 224</span>
224:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_specs</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">gem_specs</span>)
225:     <span class="ruby-identifier">gem_specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
226:       <span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">spec</span>
227:     <span class="ruby-keyword kw">end</span>
228:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005840">
                    
                    <a name="M005840"></a><b>all_gems</b>()
                    
                </div>
                
                <div class="description">
                  <p>
TODO: remove method
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005840_source')" id="l_M005840_source">show</a>
                        
                    </p>
                    <div id="M005840_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 131</span>
131:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_gems</span>
132:     <span class="ruby-ivar">@gems</span>
133:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005862">
                    
                    <a name="M005862"></a><b>dump</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005862_source')" id="l_M005862_source">show</a>
                        
                    </p>
                    <div id="M005862_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 420</span>
420:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dump</span>
421:     <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-keyword kw">self</span>)
422:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005850">
                    
                    <a name="M005850"></a><b>each</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Iterate over the specifications in the source index.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005850_source')" id="l_M005850_source">show</a>
                        
                    </p>
                    <div id="M005850_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 240</span>
240:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-comment cmt"># :yields: gem.full_name, gem</span>
241:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
242:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005856">
                    
                    <a name="M005856"></a><b>find_name</b>(gem_name, version_requirement = Gem::Requirement.default)
                    
                </div>
                
                <div class="description">
                  <p>
<a href="../Find.html">Find</a> a gem by an exact match on the short name.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005856_source')" id="l_M005856_source">show</a>
                        
                    </p>
                    <div id="M005856_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 278</span>
278:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_name</span>(<span class="ruby-identifier">gem_name</span>, <span class="ruby-identifier">version_requirement</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span>.<span class="ruby-identifier">default</span>)
279:     <span class="ruby-identifier">dep</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Dependency</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">gem_name</span>, <span class="ruby-identifier">version_requirement</span>
280:     <span class="ruby-identifier">search</span> <span class="ruby-identifier">dep</span>
281:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005853">
                    
                    <a name="M005853"></a><b>gem_signature</b>(gem_full_name)
                    
                </div>
                
                <div class="description">
                  <p>
The signature for the given gem specification.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005853_source')" id="l_M005853_source">show</a>
                        
                    </p>
                    <div id="M005853_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 264</span>
264:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gem_signature</span>(<span class="ruby-identifier">gem_full_name</span>)
265:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest'</span>
266: 
267:     <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA256</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-ivar">@gems</span>[<span class="ruby-identifier">gem_full_name</span>].<span class="ruby-identifier">to_yaml</span>).<span class="ruby-identifier">to_s</span>
268:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005852">
                    
                    <a name="M005852"></a><b>index_signature</b>()
                    
                </div>
                
                <div class="description">
                  <p>
The signature for the source index. Changes in the signature indicate a
change in the index.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005852_source')" id="l_M005852_source">show</a>
                        
                    </p>
                    <div id="M005852_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 255</span>
255:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index_signature</span>
256:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'digest'</span>
257: 
258:     <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA256</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)).<span class="ruby-identifier">to_s</span>
259:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005844">
                    
                    <a name="M005844"></a><b>latest_specs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns an <a href="../Array.html">Array</a> specifications for the latest
released versions of each gem in this index.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005844_source')" id="l_M005844_source">show</a>
                        
                    </p>
                    <div id="M005844_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 165</span>
165:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">latest_specs</span>
166:     <span class="ruby-identifier">result</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>,<span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = [] }
167:     <span class="ruby-identifier">latest</span> = {}
168: 
169:     <span class="ruby-identifier">sort</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
170:       <span class="ruby-identifier">name</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name</span>
171:       <span class="ruby-identifier">curr_ver</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">version</span>
172:       <span class="ruby-identifier">prev_ver</span> = <span class="ruby-identifier">latest</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">name</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">latest</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">version</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
173: 
174:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">curr_ver</span>.<span class="ruby-identifier">prerelease?</span>
175:       <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">prev_ver</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">curr_ver</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">prev_ver</span> <span class="ruby-keyword kw">or</span>
176:                   <span class="ruby-identifier">latest</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">platform</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span>
177: 
178:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prev_ver</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">or</span>
179:          (<span class="ruby-identifier">curr_ver</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">prev_ver</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">platform</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span>) <span class="ruby-keyword kw">then</span>
180:         <span class="ruby-identifier">result</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">clear</span>
181:         <span class="ruby-identifier">latest</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">spec</span>
182:       <span class="ruby-keyword kw">end</span>
183: 
184:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">platform</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span><span class="ruby-operator">::</span><span class="ruby-constant">RUBY</span> <span class="ruby-keyword kw">then</span>
185:         <span class="ruby-identifier">result</span>[<span class="ruby-identifier">name</span>].<span class="ruby-identifier">delete_if</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result_spec</span><span class="ruby-operator">|</span>
186:           <span class="ruby-identifier">result_spec</span>.<span class="ruby-identifier">platform</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">platform</span>
187:         <span class="ruby-keyword kw">end</span>
188:       <span class="ruby-keyword kw">end</span>
189: 
190:       <span class="ruby-identifier">result</span>[<span class="ruby-identifier">name</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">spec</span>
191:     <span class="ruby-keyword kw">end</span>
192: 
193:     <span class="ruby-comment cmt"># TODO: why is this a hash while @gems is an array? Seems like</span>
194:     <span class="ruby-comment cmt"># structural similarity would be good.</span>
195:     <span class="ruby-identifier">result</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>
196:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005855">
                    
                    <a name="M005855"></a><b>length</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="SourceIndex.html#M005854">size</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M005843">
                    
                    <a name="M005843"></a><b>load_gems_in</b>(*spec_dirs)
                    
                </div>
                
                <div class="description">
                  <p>
Reconstruct the source index from the specifications in <tt><a
href="SourceIndex.html#spec_dirs">spec_dirs</a></tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005843_source')" id="l_M005843_source">show</a>
                        
                    </p>
                    <div id="M005843_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 146</span>
146:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_gems_in</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">spec_dirs</span>)
147:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">clear</span>
148: 
149:     <span class="ruby-identifier">spec_dirs</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec_dir</span><span class="ruby-operator">|</span>
150:       <span class="ruby-identifier">spec_files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">spec_dir</span>, <span class="ruby-value str">'*.gemspec'</span>)
151: 
152:       <span class="ruby-identifier">spec_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec_file</span><span class="ruby-operator">|</span>
153:         <span class="ruby-identifier">gemspec</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">load_specification</span> <span class="ruby-identifier">spec_file</span>.<span class="ruby-identifier">untaint</span>
154:         <span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">gemspec</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gemspec</span>
155:       <span class="ruby-keyword kw">end</span>
156:     <span class="ruby-keyword kw">end</span>
157: 
158:     <span class="ruby-keyword kw">self</span>
159:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005859">
                    
                    <a name="M005859"></a><b>outdated</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns an <a href="../Array.html">Array</a> of Gem::Specifications that
are not up to date.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005859_source')" id="l_M005859_source">show</a>
                        
                    </p>
                    <div id="M005859_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 351</span>
351:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">outdated</span>
352:     <span class="ruby-identifier">outdateds</span> = []
353: 
354:     <span class="ruby-identifier">latest_specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">local</span><span class="ruby-operator">|</span>
355:       <span class="ruby-identifier">dependency</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Dependency</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">local</span>.<span class="ruby-identifier">name</span>, <span class="ruby-node">&quot;&gt;= #{local.version}&quot;</span>
356: 
357:       <span class="ruby-keyword kw">begin</span>
358:         <span class="ruby-identifier">fetcher</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">SpecFetcher</span>.<span class="ruby-identifier">fetcher</span>
359:         <span class="ruby-identifier">remotes</span> = <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">find_matching</span> <span class="ruby-identifier">dependency</span>
360:         <span class="ruby-identifier">remotes</span> = <span class="ruby-identifier">remotes</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">version</span>,<span class="ruby-identifier">_</span>),<span class="ruby-identifier">_</span><span class="ruby-operator">|</span> <span class="ruby-identifier">version</span> }
361:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span><span class="ruby-operator">::</span><span class="ruby-constant">FetchError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
362:         <span class="ruby-identifier">raise</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">warn_legacy</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword kw">do</span>
363:           <span class="ruby-identifier">require</span> <span class="ruby-value str">'rubygems/source_info_cache'</span>
364: 
365:           <span class="ruby-identifier">specs</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">SourceInfoCache</span>.<span class="ruby-identifier">search_with_source</span> <span class="ruby-identifier">dependency</span>, <span class="ruby-keyword kw">true</span>
366: 
367:           <span class="ruby-identifier">remotes</span> = <span class="ruby-identifier">specs</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span>,<span class="ruby-operator">|</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">version</span> }
368:         <span class="ruby-keyword kw">end</span>
369:       <span class="ruby-keyword kw">end</span>
370: 
371:       <span class="ruby-identifier">latest</span> = <span class="ruby-identifier">remotes</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">last</span>
372: 
373:       <span class="ruby-identifier">outdateds</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">local</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">latest</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">local</span>.<span class="ruby-identifier">version</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">latest</span>
374:     <span class="ruby-keyword kw">end</span>
375: 
376:     <span class="ruby-identifier">outdateds</span>
377:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005841">
                    
                    <a name="M005841"></a><b>prerelease_gems</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005841_source')" id="l_M005841_source">show</a>
                        
                    </p>
                    <div id="M005841_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prerelease_gems</span>
136:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">gem</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">gem</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">prerelease?</span> }
137:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005845">
                    
                    <a name="M005845"></a><b>prerelease_specs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
An array including only the prerelease gemspecs
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005845_source')" id="l_M005845_source">show</a>
                        
                    </p>
                    <div id="M005845_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 201</span>
201:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prerelease_specs</span>
202:     <span class="ruby-identifier">prerelease_gems</span>.<span class="ruby-identifier">values</span>
203:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005858">
                    
                    <a name="M005858"></a><b>refresh!</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Replaces the gems in the source index from specifications in the
directories this source index was created from. Raises an exception if this
source index wasn&#8217;t created from a directory (via <a
href="SourceIndex.html#M005837">from_gems_in</a> or <a
href="SourceIndex.html#M005835">from_installed_gems</a>, or having <a
href="SourceIndex.html#spec_dirs">spec_dirs</a> set).
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005858_source')" id="l_M005858_source">show</a>
                        
                    </p>
                    <div id="M005858_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 343</span>
343:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">refresh!</span>
344:     <span class="ruby-identifier">raise</span> <span class="ruby-value str">'source index not created from disk'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@spec_dirs</span>.<span class="ruby-identifier">nil?</span>
345:     <span class="ruby-identifier">load_gems_in</span>(<span class="ruby-operator">*</span><span class="ruby-ivar">@spec_dirs</span>)
346:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005842">
                    
                    <a name="M005842"></a><b>released_gems</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005842_source')" id="l_M005842_source">show</a>
                        
                    </p>
                    <div id="M005842_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 139</span>
139:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">released_gems</span>
140:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">gem</span><span class="ruby-operator">|</span> <span class="ruby-identifier">gem</span>.<span class="ruby-identifier">version</span>.<span class="ruby-identifier">prerelease?</span> }
141:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005846">
                    
                    <a name="M005846"></a><b>released_specs</b>()
                    
                </div>
                
                <div class="description">
                  <p>
An array including only the released gemspecs
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005846_source')" id="l_M005846_source">show</a>
                        
                    </p>
                    <div id="M005846_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 208</span>
208:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">released_specs</span>
209:     <span class="ruby-identifier">released_gems</span>.<span class="ruby-identifier">values</span>
210:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005849">
                    
                    <a name="M005849"></a><b>remove_spec</b>(full_name)
                    
                </div>
                
                <div class="description">
                  <p>
Remove a gem specification named <tt>full_name</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005849_source')" id="l_M005849_source">show</a>
                        
                    </p>
                    <div id="M005849_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 233</span>
233:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_spec</span>(<span class="ruby-identifier">full_name</span>)
234:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">full_name</span>
235:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005857">
                    
                    <a name="M005857"></a><b>search</b>(gem_pattern, platform_only = false)
                    
                </div>
                
                <div class="description">
                  <p>
Search for a gem by <a href="Dependency.html">Gem::Dependency</a>
<tt>gem_pattern</tt>. If <tt>only_platform</tt> is true, only gems matching
<a href="Platform.html#M005707">Gem::Platform.local</a> will be returned.
An <a href="../Array.html">Array</a> of matching <a
href="Specification.html">Gem::Specification</a> objects is returned.
</p>
<p>
For backwards compatibility, a <a href="../String.html">String</a> or <a
href="../Regexp.html">Regexp</a> pattern may be passed as
<tt>gem_pattern</tt>, and a <a href="Requirement.html">Gem::Requirement</a>
for <tt>platform_only</tt>. This behavior is deprecated and will be
removed.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005857_source')" id="l_M005857_source">show</a>
                        
                    </p>
                    <div id="M005857_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 292</span>
292:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">search</span>(<span class="ruby-identifier">gem_pattern</span>, <span class="ruby-identifier">platform_only</span> = <span class="ruby-keyword kw">false</span>)
293:     <span class="ruby-identifier">version_requirement</span> = <span class="ruby-keyword kw">nil</span>
294:     <span class="ruby-identifier">only_platform</span> = <span class="ruby-keyword kw">false</span>
295: 
296:     <span class="ruby-comment cmt"># TODO - Remove support and warning for legacy arguments after 2008/11</span>
297:     <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Dependency</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">gem_pattern</span>
298:       <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;#{Gem.location_of_caller.join ':'}:Warning: Gem::SourceIndex#search support for #{gem_pattern.class} patterns is deprecated, use #find_name&quot;</span>
299:     <span class="ruby-keyword kw">end</span>
300: 
301:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">gem_pattern</span>
302:     <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Regexp</span> <span class="ruby-keyword kw">then</span>
303:       <span class="ruby-identifier">version_requirement</span> = <span class="ruby-identifier">platform_only</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span>.<span class="ruby-identifier">default</span>
304:     <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Dependency</span> <span class="ruby-keyword kw">then</span>
305:       <span class="ruby-identifier">only_platform</span> = <span class="ruby-identifier">platform_only</span>
306:       <span class="ruby-identifier">version_requirement</span> = <span class="ruby-identifier">gem_pattern</span>.<span class="ruby-identifier">requirement</span>
307:       <span class="ruby-identifier">gem_pattern</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Regexp</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">gem_pattern</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">then</span>
308:                       <span class="ruby-identifier">gem_pattern</span>.<span class="ruby-identifier">name</span>
309:                     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">gem_pattern</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">then</span>
310:                       <span class="ruby-regexp re">//</span>
311:                     <span class="ruby-keyword kw">else</span>
312:                       <span class="ruby-node">/^#{Regexp.escape gem_pattern.name}$/</span>
313:                     <span class="ruby-keyword kw">end</span>
314:     <span class="ruby-keyword kw">else</span>
315:       <span class="ruby-identifier">version_requirement</span> = <span class="ruby-identifier">platform_only</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span>.<span class="ruby-identifier">default</span>
316:       <span class="ruby-identifier">gem_pattern</span> = <span class="ruby-node">/#{gem_pattern}/i</span>
317:     <span class="ruby-keyword kw">end</span>
318: 
319:     <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">version_requirement</span> <span class="ruby-keyword kw">then</span>
320:       <span class="ruby-identifier">version_requirement</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Requirement</span>.<span class="ruby-identifier">create</span> <span class="ruby-identifier">version_requirement</span>
321:     <span class="ruby-keyword kw">end</span>
322: 
323:     <span class="ruby-identifier">specs</span> = <span class="ruby-identifier">all_gems</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
324:       <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">gem_pattern</span> <span class="ruby-keyword kw">and</span>
325:         <span class="ruby-identifier">version_requirement</span>.<span class="ruby-identifier">satisfied_by?</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">version</span>
326:     <span class="ruby-keyword kw">end</span>
327: 
328:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">only_platform</span> <span class="ruby-keyword kw">then</span>
329:       <span class="ruby-identifier">specs</span> = <span class="ruby-identifier">specs</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
330:         <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Platform</span>.<span class="ruby-identifier">match</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">platform</span>
331:       <span class="ruby-keyword kw">end</span>
332:     <span class="ruby-keyword kw">end</span>
333: 
334:     <span class="ruby-identifier">specs</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">sort_obj</span> }
335:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005854">
                    
                    <a name="M005854"></a><b>size</b>()
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="SourceIndex.html#M005855">length</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005854_source')" id="l_M005854_source">show</a>
                        
                    </p>
                    <div id="M005854_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 270</span>
270:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">size</span>
271:     <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">size</span>
272:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005851">
                    
                    <a name="M005851"></a><b>specification</b>(full_name)
                    
                </div>
                
                <div class="description">
                  <p>
The gem specification given a full gem spec name.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005851_source')" id="l_M005851_source">show</a>
                        
                    </p>
                    <div id="M005851_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">specification</span>(<span class="ruby-identifier">full_name</span>)
248:     <span class="ruby-ivar">@gems</span>[<span class="ruby-identifier">full_name</span>]
249:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005860">
                    
                    <a name="M005860"></a><b>update</b>(source_uri, all)
                    
                </div>
                
                <div class="description">
                  <p>
Updates this <a href="SourceIndex.html">SourceIndex</a> from
<tt>source_uri</tt>. If <tt>all</tt> is false, only the latest gems are
fetched.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005860_source')" id="l_M005860_source">show</a>
                        
                    </p>
                    <div id="M005860_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 383</span>
383:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">all</span>)
384:     <span class="ruby-identifier">source_uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">source_uri</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">Generic</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">source_uri</span>
385:     <span class="ruby-identifier">source_uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">'/'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">source_uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\/$/</span>
386: 
387:     <span class="ruby-identifier">use_incremental</span> = <span class="ruby-keyword kw">false</span>
388: 
389:     <span class="ruby-keyword kw">begin</span>
390:       <span class="ruby-identifier">gem_names</span> = <span class="ruby-identifier">fetch_quick_index</span> <span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">all</span>
391:       <span class="ruby-identifier">remove_extra</span> <span class="ruby-identifier">gem_names</span>
392:       <span class="ruby-identifier">missing_gems</span> = <span class="ruby-identifier">find_missing</span> <span class="ruby-identifier">gem_names</span>
393: 
394:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">missing_gems</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">zero?</span>
395: 
396:       <span class="ruby-identifier">say</span> <span class="ruby-node">&quot;Missing metadata for #{missing_gems.size} gems&quot;</span> <span class="ruby-keyword kw">if</span>
397:       <span class="ruby-identifier">missing_gems</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
398: 
399:       <span class="ruby-identifier">use_incremental</span> = <span class="ruby-identifier">missing_gems</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">bulk_threshold</span>
400:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">OperationNotSupportedError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
401:       <span class="ruby-identifier">alert_error</span> <span class="ruby-node">&quot;Falling back to bulk fetch: #{ex.message}&quot;</span> <span class="ruby-keyword kw">if</span>
402:       <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
403:       <span class="ruby-identifier">use_incremental</span> = <span class="ruby-keyword kw">false</span>
404:     <span class="ruby-keyword kw">end</span>
405: 
406:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">use_incremental</span> <span class="ruby-keyword kw">then</span>
407:       <span class="ruby-identifier">update_with_missing</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">missing_gems</span>)
408:     <span class="ruby-keyword kw">else</span>
409:       <span class="ruby-identifier">new_index</span> = <span class="ruby-identifier">fetch_bulk_index</span>(<span class="ruby-identifier">source_uri</span>)
410:       <span class="ruby-ivar">@gems</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">new_index</span>.<span class="ruby-identifier">gems</span>)
411:     <span class="ruby-keyword kw">end</span>
412: 
413:     <span class="ruby-keyword kw">true</span>
414:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M005865">
                    
                    <a name="M005865"></a><b>fetch_bulk_index</b>(source_uri)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005865_source')" id="l_M005865_source">show</a>
                        
                    </p>
                    <div id="M005865_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 466</span>
466:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_bulk_index</span>(<span class="ruby-identifier">source_uri</span>)
467:     <span class="ruby-identifier">say</span> <span class="ruby-node">&quot;Bulk updating Gem source index for: #{source_uri}&quot;</span> <span class="ruby-keyword kw">if</span>
468:       <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">verbose</span>
469: 
470:     <span class="ruby-identifier">index</span> = <span class="ruby-identifier">fetch_index_from</span>(<span class="ruby-identifier">source_uri</span>)
471:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">then</span>
472:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteSourceException</span>,
473:               <span class="ruby-node">&quot;Error fetching remote gem cache: #{@fetch_error}&quot;</span>
474:     <span class="ruby-keyword kw">end</span>
475:     <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-keyword kw">nil</span>
476:     <span class="ruby-identifier">index</span>
477:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005864">
                    
                    <a name="M005864"></a><b>fetch_index_from</b>(source_uri)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005864_source')" id="l_M005864_source">show</a>
                        
                    </p>
                    <div id="M005864_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 432</span>
432:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_index_from</span>(<span class="ruby-identifier">source_uri</span>)
433:     <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-keyword kw">nil</span>
434: 
435:     <span class="ruby-identifier">indexes</span> = ??[
436:         <span class="ruby-constant">Marshal</span>.<span class="ruby-comment cmt">#{Gem.marshal_version}.Z</span>
437:         <span class="ruby-constant">Marshal</span>.<span class="ruby-comment cmt">#{Gem.marshal_version}</span>
438:         <span class="ruby-identifier">yaml</span>.<span class="ruby-constant">Z</span>
439:         <span class="ruby-identifier">yaml</span>
440:       ]
441: 
442:     <span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
443:       <span class="ruby-identifier">spec_data</span> = <span class="ruby-keyword kw">nil</span>
444:       <span class="ruby-identifier">index</span> = <span class="ruby-identifier">source_uri</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">name</span>
445:       <span class="ruby-keyword kw">begin</span>
446:         <span class="ruby-identifier">spec_data</span> = <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">fetch_path</span> <span class="ruby-identifier">index</span>
447:         <span class="ruby-identifier">spec_data</span> = <span class="ruby-identifier">unzip</span>(<span class="ruby-identifier">spec_data</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.Z$/</span>
448: 
449:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/Marshal/</span> <span class="ruby-keyword kw">then</span>
450:           <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">spec_data</span>)
451:         <span class="ruby-keyword kw">else</span>
452:           <span class="ruby-keyword kw">return</span> <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">spec_data</span>)
453:         <span class="ruby-keyword kw">end</span>
454:       <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
455:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span> <span class="ruby-keyword kw">then</span>
456:           <span class="ruby-identifier">alert_error</span> <span class="ruby-node">&quot;Unable to fetch #{name}: #{e.message}&quot;</span>
457:         <span class="ruby-keyword kw">end</span>
458: 
459:         <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-identifier">e</span>
460:       <span class="ruby-keyword kw">end</span>
461:     <span class="ruby-keyword kw">end</span>
462: 
463:     <span class="ruby-keyword kw">nil</span>
464:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005866">
                    
                    <a name="M005866"></a><b>fetch_quick_index</b>(source_uri, all)
                    
                </div>
                
                <div class="description">
                  <p>
Get the quick index needed for incremental updates.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005866_source')" id="l_M005866_source">show</a>
                        
                    </p>
                    <div id="M005866_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 482</span>
482:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_quick_index</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">all</span>)
483:     <span class="ruby-identifier">index</span> = <span class="ruby-identifier">all</span> <span class="ruby-value">? </span><span class="ruby-value str">'index'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">'latest_index'</span>
484: 
485:     <span class="ruby-identifier">zipped_index</span> = <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">fetch_path</span> <span class="ruby-identifier">source_uri</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;quick/#{index}.rz&quot;</span>
486: 
487:     <span class="ruby-identifier">unzip</span>(<span class="ruby-identifier">zipped_index</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
488:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-operator">::</span><span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
489:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">all</span> <span class="ruby-keyword kw">then</span>
490:       <span class="ruby-identifier">say</span> <span class="ruby-value str">&quot;Latest index not found, using quick index&quot;</span> <span class="ruby-keyword kw">if</span>
491:         <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
492: 
493:       <span class="ruby-identifier">fetch_quick_index</span> <span class="ruby-identifier">source_uri</span>, <span class="ruby-keyword kw">true</span>
494:     <span class="ruby-keyword kw">else</span>
495:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">OperationNotSupportedError</span>,
496:             <span class="ruby-node">&quot;No quick index found: #{e.message}&quot;</span>
497:     <span class="ruby-keyword kw">end</span>
498:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005870">
                    
                    <a name="M005870"></a><b>fetch_single_spec</b>(source_uri, spec_name)
                    
                </div>
                
                <div class="description">
                  <p>
Tries to fetch <a href="../Marshal.html">Marshal</a> representation first,
then <a href="../YAML.html">YAML</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005870_source')" id="l_M005870_source">show</a>
                        
                    </p>
                    <div id="M005870_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 534</span>
534:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch_single_spec</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">spec_name</span>)
535:     <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-keyword kw">nil</span>
536: 
537:     <span class="ruby-keyword kw">begin</span>
538:       <span class="ruby-identifier">marshal_uri</span> = <span class="ruby-identifier">source_uri</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;quick/Marshal.#{Gem.marshal_version}/#{spec_name}.gemspec.rz&quot;</span>
539:       <span class="ruby-identifier">zipped</span> = <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">fetch_path</span> <span class="ruby-identifier">marshal_uri</span>
540:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">unzip</span>(<span class="ruby-identifier">zipped</span>))
541:     <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
542:       <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-identifier">ex</span>
543: 
544:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span> <span class="ruby-keyword kw">then</span>
545:         <span class="ruby-identifier">say</span> <span class="ruby-node">&quot;unable to fetch marshal gemspec #{marshal_uri}: #{ex.class} - #{ex}&quot;</span>
546:       <span class="ruby-keyword kw">end</span>
547:     <span class="ruby-keyword kw">end</span>
548: 
549:     <span class="ruby-keyword kw">begin</span>
550:       <span class="ruby-identifier">yaml_uri</span> = <span class="ruby-identifier">source_uri</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;quick/#{spec_name}.gemspec.rz&quot;</span>
551:       <span class="ruby-identifier">zipped</span> = <span class="ruby-identifier">fetcher</span>.<span class="ruby-identifier">fetch_path</span> <span class="ruby-identifier">yaml_uri</span>
552:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">unzip</span>(<span class="ruby-identifier">zipped</span>))
553:     <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
554:       <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-identifier">ex</span>
555:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span> <span class="ruby-keyword kw">then</span>
556:         <span class="ruby-identifier">say</span> <span class="ruby-node">&quot;unable to fetch YAML gemspec #{yaml_uri}: #{ex.class} - #{ex}&quot;</span>
557:       <span class="ruby-keyword kw">end</span>
558:     <span class="ruby-keyword kw">end</span>
559: 
560:     <span class="ruby-keyword kw">nil</span>
561:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005863">
                    
                    <a name="M005863"></a><b>fetcher</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005863_source')" id="l_M005863_source">show</a>
                        
                    </p>
                    <div id="M005863_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 426</span>
426:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetcher</span>
427:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'rubygems/remote_fetcher'</span>
428: 
429:     <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">RemoteFetcher</span>.<span class="ruby-identifier">fetcher</span>
430:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005867">
                    
                    <a name="M005867"></a><b>find_missing</b>(spec_names)
                    
                </div>
                
                <div class="description">
                  <p>
Make a list of full names for all the missing gemspecs.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005867_source')" id="l_M005867_source">show</a>
                        
                    </p>
                    <div id="M005867_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 503</span>
503:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_missing</span>(<span class="ruby-identifier">spec_names</span>)
504:     <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-ivar">@originals</span> <span class="ruby-keyword kw">then</span>
505:       <span class="ruby-ivar">@originals</span> = {}
506:       <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
507:         <span class="ruby-ivar">@originals</span>[<span class="ruby-identifier">spec</span>.<span class="ruby-identifier">original_name</span>] = <span class="ruby-identifier">spec</span>
508:       <span class="ruby-keyword kw">end</span>
509:     <span class="ruby-keyword kw">end</span>
510: 
511:     <span class="ruby-identifier">spec_names</span>.<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">full_name</span><span class="ruby-operator">|</span>
512:       <span class="ruby-ivar">@originals</span>[<span class="ruby-identifier">full_name</span>].<span class="ruby-identifier">nil?</span>
513:     }
514:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005868">
                    
                    <a name="M005868"></a><b>remove_extra</b>(spec_names)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005868_source')" id="l_M005868_source">show</a>
                        
                    </p>
                    <div id="M005868_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 516</span>
516:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_extra</span>(<span class="ruby-identifier">spec_names</span>)
517:     <span class="ruby-identifier">dictionary</span> = <span class="ruby-identifier">spec_names</span>.<span class="ruby-identifier">inject</span>({}) { <span class="ruby-operator">|</span><span class="ruby-identifier">h</span>, <span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-keyword kw">true</span>; <span class="ruby-identifier">h</span> }
518:     <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
519:       <span class="ruby-identifier">remove_spec</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">dictionary</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">original_name</span>
520:     <span class="ruby-keyword kw">end</span>
521:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005869">
                    
                    <a name="M005869"></a><b>unzip</b>(string)
                    
                </div>
                
                <div class="description">
                  <p>
Unzip the given string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005869_source')" id="l_M005869_source">show</a>
                        
                    </p>
                    <div id="M005869_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 526</span>
526:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unzip</span>(<span class="ruby-identifier">string</span>)
527:     <span class="ruby-identifier">require</span> <span class="ruby-value str">'zlib'</span>
528:     <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">inflate</span> <span class="ruby-identifier">string</span>
529:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M005871">
                    
                    <a name="M005871"></a><b>update_with_missing</b>(source_uri, missing_names)
                    
                </div>
                
                <div class="description">
                  <p>
Update the cached source index with the missing names.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M005871_source')" id="l_M005871_source">show</a>
                        
                    </p>
                    <div id="M005871_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rubygems/source_index.rb, line 566</span>
566:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_with_missing</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">missing_names</span>)
567:     <span class="ruby-identifier">progress</span> = <span class="ruby-identifier">ui</span>.<span class="ruby-identifier">progress_reporter</span>(<span class="ruby-identifier">missing_names</span>.<span class="ruby-identifier">size</span>,
568:         <span class="ruby-node">&quot;Updating metadata for #{missing_names.size} gems from #{source_uri}&quot;</span>)
569:     <span class="ruby-identifier">missing_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec_name</span><span class="ruby-operator">|</span>
570:       <span class="ruby-identifier">gemspec</span> = <span class="ruby-identifier">fetch_single_spec</span>(<span class="ruby-identifier">source_uri</span>, <span class="ruby-identifier">spec_name</span>)
571:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gemspec</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">then</span>
572:         <span class="ruby-identifier">ui</span>.<span class="ruby-identifier">say</span> <span class="ruby-node">&quot;Failed to download spec #{spec_name} from #{source_uri}:\n&quot;</span> \
573:                  <span class="ruby-node">&quot;\t#{@fetch_error.message}&quot;</span>
574:       <span class="ruby-keyword kw">else</span>
575:         <span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">gemspec</span>
576:         <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">updated</span> <span class="ruby-identifier">spec_name</span>
577:       <span class="ruby-keyword kw">end</span>
578:       <span class="ruby-ivar">@fetch_error</span> = <span class="ruby-keyword kw">nil</span>
579:     <span class="ruby-keyword kw">end</span>
580:     <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">done</span>
581:     <span class="ruby-identifier">progress</span>.<span class="ruby-identifier">count</span>
582:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    