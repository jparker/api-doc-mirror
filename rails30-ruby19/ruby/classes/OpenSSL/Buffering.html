<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>OpenSSL::Buffering</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            OpenSSL::Buffering 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/ext/openssl/lib/openssl/buffering_rb.html">ext/openssl/lib/openssl/buffering.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M007271"><<</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M007276">close</a>,</li>
                
                <li><a href="#M007253">consume_rbuff</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M007268">do_write</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M007258">each</a>,</li>
                
                <li><a href="#M007263">each_byte</a>,</li>
                
                <li><a href="#M007259">each_line</a>,</li>
                
                <li><a href="#M007267">eof</a>,</li>
                
                <li><a href="#M007266">eof?</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M007252">fill_rbuff</a>,</li>
                
                <li><a href="#M007275">flush</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M007262">getc</a>,</li>
                
                <li><a href="#M007257">gets</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M007251">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M007273">print</a>,</li>
                
                <li><a href="#M007274">printf</a>,</li>
                
                <li><a href="#M007272">puts</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M007254">read</a>,</li>
                
                <li><a href="#M007256">read_nonblock</a>,</li>
                
                <li><a href="#M007264">readchar</a>,</li>
                
                <li><a href="#M007261">readline</a>,</li>
                
                <li><a href="#M007260">readlines</a>,</li>
                
                <li><a href="#M007255">readpartial</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M007265">ungetc</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M007269">write</a>,</li>
                
                <li><a href="#M007270">write_nonblock</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../Kernel.html">Kernel</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">BLOCK_SIZE</td>
            <td>=</td>
            <td class="attr-value">1024*16</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>sync</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M007251">
                    
                    <a name="M007251"></a><b>new</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007251_source')" id="l_M007251_source">show</a>
                        
                    </p>
                    <div id="M007251_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 23</span>
23:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
24:     <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">false</span>
25:     <span class="ruby-ivar">@rbuffer</span> = <span class="ruby-value str">&quot;&quot;</span>
26:     <span class="ruby-ivar">@sync</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">sync</span>
27:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M007271">
                    
                    <a name="M007271"></a><b>&lt;&lt;</b>(s)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007271_source')" id="l_M007271_source">show</a>
                        
                    </p>
                    <div id="M007271_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 295</span>
295:   <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">s</span>)
296:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
297:     <span class="ruby-keyword kw">self</span>
298:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007276">
                    
                    <a name="M007276"></a><b>close</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007276_source')" id="l_M007276_source">show</a>
                        
                    </p>
                    <div id="M007276_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 334</span>
334:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
335:     <span class="ruby-identifier">flush</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
336:     <span class="ruby-identifier">sysclose</span>
337:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007258">
                    
                    <a name="M007258"></a><b>each</b>(eol=$/)
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Buffering.html#M007259">each_line</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007258_source')" id="l_M007258_source">show</a>
                        
                    </p>
                    <div id="M007258_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
175:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">line</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
176:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">line</span>
177:     <span class="ruby-keyword kw">end</span>
178:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007263">
                    
                    <a name="M007263"></a><b>each_byte</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007263_source')" id="l_M007263_source">show</a>
                        
                    </p>
                    <div id="M007263_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 199</span>
199:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_byte</span>
200:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>
201:       <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">c</span>)
202:     <span class="ruby-keyword kw">end</span>
203:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007259">
                    
                    <a name="M007259"></a><b>each_line</b>(eol=$/)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Buffering.html#M007258">each</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M007267">
                    
                    <a name="M007267"></a><b>eof</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Buffering.html#M007266">eof?</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M007266">
                    
                    <a name="M007266"></a><b>eof?</b>()
                    
                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Buffering.html#M007267">eof</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007266_source')" id="l_M007266_source">show</a>
                        
                    </p>
                    <div id="M007266_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 214</span>
214:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eof?</span>
215:     <span class="ruby-identifier">fill_rbuff</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@eof</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
216:     <span class="ruby-ivar">@eof</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
217:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007275">
                    
                    <a name="M007275"></a><b>flush</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007275_source')" id="l_M007275_source">show</a>
                        
                    </p>
                    <div id="M007275_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 327</span>
327:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush</span>
328:     <span class="ruby-identifier">osync</span> = <span class="ruby-ivar">@sync</span>
329:     <span class="ruby-ivar">@sync</span> = <span class="ruby-keyword kw">true</span>
330:     <span class="ruby-identifier">do_write</span> <span class="ruby-value str">&quot;&quot;</span>
331:     <span class="ruby-ivar">@sync</span> = <span class="ruby-identifier">osync</span>
332:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007262">
                    
                    <a name="M007262"></a><b>getc</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007262_source')" id="l_M007262_source">show</a>
                        
                    </p>
                    <div id="M007262_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 194</span>
194:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getc</span>
195:     <span class="ruby-identifier">c</span> = <span class="ruby-identifier">read</span>(<span class="ruby-value">1</span>)
196:     <span class="ruby-identifier">c</span> <span class="ruby-value">? </span><span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
197:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007257">
                    
                    <a name="M007257"></a><b>gets</b>(eol=$/, limit=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007257_source')" id="l_M007257_source">show</a>
                        
                    </p>
                    <div id="M007257_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 156</span>
156:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>, <span class="ruby-identifier">limit</span>=<span class="ruby-keyword kw">nil</span>)
157:     <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">eol</span>)
158:     <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@eof</span>
159:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span>
160:       <span class="ruby-identifier">fill_rbuff</span>
161:       <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">eol</span>)
162:     <span class="ruby-keyword kw">end</span>
163:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eol</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)
164:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">$&amp;</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
165:     <span class="ruby-keyword kw">else</span>
166:       <span class="ruby-identifier">size</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">eol</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
167:     <span class="ruby-keyword kw">end</span>
168:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">limit</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">limit</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>
169:       <span class="ruby-identifier">size</span> = [<span class="ruby-identifier">size</span>, <span class="ruby-identifier">limit</span>].<span class="ruby-identifier">min</span>
170:     <span class="ruby-keyword kw">end</span>
171:     <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>)
172:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007273">
                    
                    <a name="M007273"></a><b>print</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007273_source')" id="l_M007273_source">show</a>
                        
                    </p>
                    <div id="M007273_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 315</span>
315:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
316:     <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;&quot;</span>
317:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span> }
318:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
319:     <span class="ruby-keyword kw">nil</span>
320:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007274">
                    
                    <a name="M007274"></a><b>printf</b>(s, *args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007274_source')" id="l_M007274_source">show</a>
                        
                    </p>
                    <div id="M007274_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 322</span>
322:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">printf</span>(<span class="ruby-identifier">s</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
323:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">args</span>)
324:     <span class="ruby-keyword kw">nil</span>
325:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007272">
                    
                    <a name="M007272"></a><b>puts</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007272_source')" id="l_M007272_source">show</a>
                        
                    </p>
                    <div id="M007272_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 300</span>
300:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">puts</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
301:     <span class="ruby-identifier">s</span> = <span class="ruby-value str">&quot;&quot;</span>
302:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
303:       <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
304:     <span class="ruby-keyword kw">end</span>
305:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
306:       <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>
307:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-regexp re">/\n\z/</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">s</span>
308:         <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
309:       <span class="ruby-keyword kw">end</span>
310:     }
311:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
312:     <span class="ruby-keyword kw">nil</span>
313:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007254">
                    
                    <a name="M007254"></a><b>read</b>(size=nil, buf=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007254_source')" id="l_M007254_source">show</a>
                        
                    </p>
                    <div id="M007254_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 57</span>
57:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">size</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
58:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
59:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
60:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
61:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
62:       <span class="ruby-keyword kw">else</span>
63:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
64:       <span class="ruby-keyword kw">end</span>
65:     <span class="ruby-keyword kw">end</span>
66:     <span class="ruby-keyword kw">until</span> <span class="ruby-ivar">@eof</span>
67:       <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">size</span>
68:       <span class="ruby-identifier">fill_rbuff</span>
69:     <span class="ruby-keyword kw">end</span>
70:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>) <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>
71:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
72:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
73:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
74:     <span class="ruby-keyword kw">end</span>
75:     (<span class="ruby-identifier">size</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ret</span>
76:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007256">
                    
                    <a name="M007256"></a><b>read_nonblock</b>(maxlen, buf=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Reads at most <em>maxlen</em> bytes in the non-blocking manner.
</p>
<p>
When no data can be read without blocking, It raises <a
href="SSL/SSLError.html">OpenSSL::SSL::SSLError</a> extended by <a
href="../IO/WaitReadable.html">IO::WaitReadable</a> or <a
href="../IO/WaitWritable.html">IO::WaitWritable</a>.
</p>
<p>
<a href="../IO/WaitReadable.html">IO::WaitReadable</a> means <a
href="SSL.html">SSL</a> needs to read internally. So <a
href="Buffering.html#M007256">read_nonblock</a> should be called again
after underlying <a href="../IO.html">IO</a> is readable.
</p>
<p>
<a href="../IO/WaitWritable.html">IO::WaitWritable</a> means <a
href="SSL.html">SSL</a> needs to write internally. So <a
href="Buffering.html#M007256">read_nonblock</a> should be called again
after underlying <a href="../IO.html">IO</a> is writable.
</p>
<p>
So <a href="Buffering.html#M007256">OpenSSL::Buffering#read_nonblock</a>
needs two rescue clause as follows.
</p>
<pre>
 # emulates blocking read (readpartial).
 begin
   result = ssl.read_nonblock(maxlen)
 rescue IO::WaitReadable
   IO.select([io])
   retry
 rescue IO::WaitWritable
   IO.select(nil, [io])
   retry
 end
</pre>
<p>
Note that one reason that <a
href="Buffering.html#M007256">read_nonblock</a> write to a underlying <a
href="../IO.html">IO</a> is the peer requests a new TLS/SSL handshake. See
openssl FAQ for more details. <a
href="http://www.openssl.org/support/faq.html">www.openssl.org/support/faq.html</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007256_source')" id="l_M007256_source">show</a>
                        
                    </p>
                    <div id="M007256_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 135</span>
135:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_nonblock</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
136:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">maxlen</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
137:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
138:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
139:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
140:       <span class="ruby-keyword kw">else</span>
141:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
142:       <span class="ruby-keyword kw">end</span>
143:     <span class="ruby-keyword kw">end</span>
144:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
145:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sysread_nonblock</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>)
146:     <span class="ruby-keyword kw">end</span>
147:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">maxlen</span>)
148:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
149:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
150:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
151:     <span class="ruby-keyword kw">end</span>
152:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>
153:     <span class="ruby-identifier">ret</span>
154:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007264">
                    
                    <a name="M007264"></a><b>readchar</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007264_source')" id="l_M007264_source">show</a>
                        
                    </p>
                    <div id="M007264_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 205</span>
205:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readchar</span>
206:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
207:     <span class="ruby-identifier">getc</span>
208:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007261">
                    
                    <a name="M007261"></a><b>readline</b>(eol=$/)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007261_source')" id="l_M007261_source">show</a>
                        
                    </p>
                    <div id="M007261_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 189</span>
189:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readline</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
190:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">eof?</span>
191:     <span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
192:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007260">
                    
                    <a name="M007260"></a><b>readlines</b>(eol=$/)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007260_source')" id="l_M007260_source">show</a>
                        
                    </p>
                    <div id="M007260_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 181</span>
181:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">eol</span>=<span class="ruby-identifier">$/</span>)
182:     <span class="ruby-identifier">ary</span> = []
183:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">line</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-identifier">eol</span>)
184:       <span class="ruby-identifier">ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
185:     <span class="ruby-keyword kw">end</span>
186:     <span class="ruby-identifier">ary</span>
187:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007255">
                    
                    <a name="M007255"></a><b>readpartial</b>(maxlen, buf=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007255_source')" id="l_M007255_source">show</a>
                        
                    </p>
                    <div id="M007255_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 78</span>
 78:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">readpartial</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>=<span class="ruby-keyword kw">nil</span>)
 79:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">maxlen</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
 80:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
 81:         <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">clear</span>
 82:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buf</span>
 83:       <span class="ruby-keyword kw">else</span>
 84:         <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;&quot;</span>
 85:       <span class="ruby-keyword kw">end</span>
 86:     <span class="ruby-keyword kw">end</span>
 87:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
 88:       <span class="ruby-keyword kw">begin</span>
 89:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sysread</span>(<span class="ruby-identifier">maxlen</span>, <span class="ruby-identifier">buf</span>)
 90:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
 91:         <span class="ruby-keyword kw">retry</span>
 92:       <span class="ruby-keyword kw">end</span>
 93:     <span class="ruby-keyword kw">end</span>
 94:     <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">maxlen</span>)
 95:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">buf</span>
 96:       <span class="ruby-identifier">buf</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">ret</span>)
 97:       <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">buf</span>
 98:     <span class="ruby-keyword kw">end</span>
 99:     <span class="ruby-identifier">raise</span> <span class="ruby-constant">EOFError</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">empty?</span>
100:     <span class="ruby-identifier">ret</span>
101:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007265">
                    
                    <a name="M007265"></a><b>ungetc</b>(c)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007265_source')" id="l_M007265_source">show</a>
                        
                    </p>
                    <div id="M007265_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 210</span>
210:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ungetc</span>(<span class="ruby-identifier">c</span>)
211:     <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>,<span class="ruby-value">0</span>] = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">chr</span>
212:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007269">
                    
                    <a name="M007269"></a><b>write</b>(s)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007269_source')" id="l_M007269_source">show</a>
                        
                    </p>
                    <div id="M007269_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 248</span>
248:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">s</span>)
249:     <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
250:     <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span>
251:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007270">
                    
                    <a name="M007270"></a><b>write_nonblock</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
Writes <em>str</em> in the non-blocking manner.
</p>
<p>
If there are buffered data, it is flushed at first. This may block.
</p>
<p>
<a href="Buffering.html#M007270">write_nonblock</a> returns number of bytes
written to the <a href="SSL.html">SSL</a> connection.
</p>
<p>
When no data can be written without blocking, It raises <a
href="SSL/SSLError.html">OpenSSL::SSL::SSLError</a> extended by <a
href="../IO/WaitReadable.html">IO::WaitReadable</a> or <a
href="../IO/WaitWritable.html">IO::WaitWritable</a>.
</p>
<p>
<a href="../IO/WaitReadable.html">IO::WaitReadable</a> means <a
href="SSL.html">SSL</a> needs to read internally. So <a
href="Buffering.html#M007270">write_nonblock</a> should be called again
after underlying <a href="../IO.html">IO</a> is readable.
</p>
<p>
<a href="../IO/WaitWritable.html">IO::WaitWritable</a> means <a
href="SSL.html">SSL</a> needs to write internally. So <a
href="Buffering.html#M007270">write_nonblock</a> should be called again
after underlying <a href="../IO.html">IO</a> is writable.
</p>
<p>
So <a href="Buffering.html#M007270">OpenSSL::Buffering#write_nonblock</a>
needs two rescue clause as follows.
</p>
<pre>
 # emulates blocking write.
 begin
   result = ssl.write_nonblock(str)
 rescue IO::WaitReadable
   IO.select([io])
   retry
 rescue IO::WaitWritable
   IO.select(nil, [io])
   retry
 end
</pre>
<p>
Note that one reason that <a
href="Buffering.html#M007270">write_nonblock</a> read from a underlying <a
href="../IO.html">IO</a> is the peer requests a new TLS/SSL handshake. See
openssl FAQ for more details. <a
href="http://www.openssl.org/support/faq.html">www.openssl.org/support/faq.html</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007270_source')" id="l_M007270_source">show</a>
                        
                    </p>
                    <div id="M007270_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 290</span>
290:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_nonblock</span>(<span class="ruby-identifier">s</span>)
291:     <span class="ruby-identifier">flush</span>
292:     <span class="ruby-identifier">syswrite_nonblock</span>(<span class="ruby-identifier">s</span>)
293:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Private methods</div>
            
            <div class="method">
                <div class="title" id="M007253">
                    
                    <a name="M007253"></a><b>consume_rbuff</b>(size=nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007253_source')" id="l_M007253_source">show</a>
                        
                    </p>
                    <div id="M007253_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 44</span>
44:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">consume_rbuff</span>(<span class="ruby-identifier">size</span>=<span class="ruby-keyword kw">nil</span>)
45:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">empty?</span>
46:       <span class="ruby-keyword kw">nil</span>
47:     <span class="ruby-keyword kw">else</span>
48:       <span class="ruby-identifier">size</span> = <span class="ruby-ivar">@rbuffer</span>.<span class="ruby-identifier">size</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">size</span>
49:       <span class="ruby-identifier">ret</span> = <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">size</span>]
50:       <span class="ruby-ivar">@rbuffer</span>[<span class="ruby-value">0</span>, <span class="ruby-identifier">size</span>] = <span class="ruby-value str">&quot;&quot;</span>
51:       <span class="ruby-identifier">ret</span>
52:     <span class="ruby-keyword kw">end</span>
53:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007268">
                    
                    <a name="M007268"></a><b>do_write</b>(s)
                    
                </div>
                
                <div class="description">
                  <p>
for writing.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007268_source')" id="l_M007268_source">show</a>
                        
                    </p>
                    <div id="M007268_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 225</span>
225:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">do_write</span>(<span class="ruby-identifier">s</span>)
226:     <span class="ruby-ivar">@wbuffer</span> = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">defined?</span> <span class="ruby-ivar">@wbuffer</span>
227:     <span class="ruby-ivar">@wbuffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">s</span>
228:     <span class="ruby-ivar">@sync</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">false</span>
229:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sync</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">BLOCK_SIZE</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-identifier">$/</span>)
230:       <span class="ruby-identifier">remain</span> = <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">idx</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$/</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@wbuffer</span>.<span class="ruby-identifier">length</span>
231:       <span class="ruby-identifier">nwritten</span> = <span class="ruby-value">0</span>
232:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">remain</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
233:         <span class="ruby-identifier">str</span> = <span class="ruby-ivar">@wbuffer</span>[<span class="ruby-identifier">nwritten</span>,<span class="ruby-identifier">remain</span>]
234:         <span class="ruby-keyword kw">begin</span>
235:           <span class="ruby-identifier">nwrote</span> = <span class="ruby-identifier">syswrite</span>(<span class="ruby-identifier">str</span>)
236:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
237:           <span class="ruby-keyword kw">retry</span>
238:         <span class="ruby-keyword kw">end</span>
239:         <span class="ruby-identifier">remain</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">nwrote</span>
240:         <span class="ruby-identifier">nwritten</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">nwrote</span>
241:       <span class="ruby-keyword kw">end</span>
242:       <span class="ruby-ivar">@wbuffer</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">nwritten</span>] = <span class="ruby-value str">&quot;&quot;</span>
243:     <span class="ruby-keyword kw">end</span>
244:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007252">
                    
                    <a name="M007252"></a><b>fill_rbuff</b>()
                    
                </div>
                
                <div class="description">
                  <p>
for reading.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007252_source')" id="l_M007252_source">show</a>
                        
                    </p>
                    <div id="M007252_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File ext/openssl/lib/openssl/buffering.rb, line 34</span>
34:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fill_rbuff</span>
35:     <span class="ruby-keyword kw">begin</span>
36:       <span class="ruby-ivar">@rbuffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">sysread</span>(<span class="ruby-constant">BLOCK_SIZE</span>)
37:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EAGAIN</span>
38:       <span class="ruby-keyword kw">retry</span>
39:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">EOFError</span>
40:       <span class="ruby-ivar">@eof</span> = <span class="ruby-keyword kw">true</span>
41:     <span class="ruby-keyword kw">end</span>
42:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    