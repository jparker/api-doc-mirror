<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Thread</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
    <script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Thread 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/vm_c.html">vm.c</a></li>
            
            <li><a href="../files/thread_c.html">thread.c</a></li>
            
            <li><a href="../files/prelude_rb.html">prelude.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
<a href="Thread.html">::Thread</a>
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M001573">DEBUG</a>,</li>
                
                <li><a href="#M001574">DEBUG=</a></li>
                
            </ul>
        </dd>
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M001584">[]</a>,</li>
                
                <li><a href="#M001585">[]=</a></li>
                
            </ul>
        </dd>
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M001571">abort_on_exception</a>,</li>
                
                <li><a href="#M001593">abort_on_exception</a>,</li>
                
                <li><a href="#M001594">abort_on_exception=</a>,</li>
                
                <li><a href="#M001572">abort_on_exception=</a>,</li>
                
                <li><a href="#M001610">add_trace_func</a>,</li>
                
                <li><a href="#M001591">alive?</a></li>
                
            </ul>
        </dd>
    
        <dt>B</dt>
        <dd>
            <ul>
                
                <li><a href="#M001597">backtrace</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M001565">current</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M001629">exclusive</a>,</li>
                
                <li><a href="#M001581">exit</a>,</li>
                
                <li><a href="#M001568">exit</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M001563">fork</a></li>
                
            </ul>
        </dd>
    
        <dt>G</dt>
        <dd>
            <ul>
                
                <li><a href="#M001596">group</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M001598">inspect</a></li>
                
            </ul>
        </dd>
    
        <dt>J</dt>
        <dd>
            <ul>
                
                <li><a href="#M001577">join</a></li>
                
            </ul>
        </dd>
    
        <dt>K</dt>
        <dd>
            <ul>
                
                <li><a href="#M001586">key?</a>,</li>
                
                <li><a href="#M001587">keys</a>,</li>
                
                <li><a href="#M001579">kill</a>,</li>
                
                <li><a href="#M001567">kill</a></li>
                
            </ul>
        </dd>
    
        <dt>L</dt>
        <dd>
            <ul>
                
                <li><a href="#M001570">list</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M001564">main</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M001569">pass</a>,</li>
                
                <li><a href="#M001588">priority</a>,</li>
                
                <li><a href="#M001589">priority=</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M001576">raise</a>,</li>
                
                <li><a href="#M001582">run</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M001595">safe_level</a>,</li>
                
                <li><a href="#M001609">set_trace_func</a>,</li>
                
                <li><a href="#M001562">start</a>,</li>
                
                <li><a href="#M001590">status</a>,</li>
                
                <li><a href="#M001566">stop</a>,</li>
                
                <li><a href="#M001592">stop?</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M001580">terminate</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M001578">value</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M001583">wakeup</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">MUTEX_FOR_THREAD_EXCLUSIVE</td>
            <td>=</td>
            <td class="attr-value">Mutex.new # :nodoc:</td>
        </tr>
        
        
    </table>
    

    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M001573">
                    
                    <a name="M001573"></a><b>Thread.DEBUG     &rarr; num
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the thread debug level. Available only if compiled with
THREAD_DEBUG=-1.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001573_source')" id="l_M001573_source">show</a>
                        
                    </p>
                    <div id="M001573_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_debug(void)
{
    return INT2NUM(rb_thread_debug_enabled);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001574">
                    
                    <a name="M001574"></a><b>Thread.DEBUG = num
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Sets the thread debug level. Available only if compiled with
THREAD_DEBUG=-1.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001574_source')" id="l_M001574_source">show</a>
                        
                    </p>
                    <div id="M001574_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_debug_set(VALUE self, VALUE val)
{
    rb_thread_debug_enabled = RTEST(val) ? NUM2INT(val) : 0;
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001571">
                    
                    <a name="M001571"></a><b>Thread.abort_on_exception   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the status of the global ``abort on exception&#8217;&#8217;
condition. The default is <tt>false</tt>. When set to <tt>true</tt>, or if
the global <tt>$DEBUG</tt> flag is <tt>true</tt> (perhaps because the
command line option <tt>-d</tt> was specified) all threads will abort (the
process will <tt>exit(0)</tt>) if an exception is raised in any thread. See
also <tt>Thread::<a
href="Thread.html#M001571">abort_on_exception</a>=</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001571_source')" id="l_M001571_source">show</a>
                        
                    </p>
                    <div id="M001571_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_abort_exc(void)
{
    return GET_THREAD()-&gt;vm-&gt;thread_abort_on_exception ? Qtrue : Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001572">
                    
                    <a name="M001572"></a><b>Thread.abort_on_exception= boolean   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
When set to <tt>true</tt>, all threads will abort if an exception is
raised. Returns the new state.
</p>
<pre>
   Thread.abort_on_exception = true
   t1 = Thread.new do
     puts  &quot;In new thread&quot;
     raise &quot;Exception from thread&quot;
   end
   sleep(1)
   puts &quot;not reached&quot;
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   In new thread
   prog.rb:4: Exception from thread (RuntimeError)
    from prog.rb:2:in `initialize'
    from prog.rb:2:in `new'
    from prog.rb:2
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001572_source')" id="l_M001572_source">show</a>
                        
                    </p>
                    <div id="M001572_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_abort_exc_set(VALUE self, VALUE val)
{
    rb_secure(4);
    GET_THREAD()-&gt;vm-&gt;thread_abort_on_exception = RTEST(val);
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001565">
                    
                    <a name="M001565"></a><b>Thread.current   &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the currently executing thread.
</p>
<pre>
   Thread.current   #=&gt; #&lt;Thread:0x401bdf4c run&gt;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001565_source')" id="l_M001565_source">show</a>
                        
                    </p>
                    <div id="M001565_source" class="dyn-source">
                        <pre>static VALUE
thread_s_current(VALUE klass)
{
    return rb_thread_current();
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001629">
                    
                    <a name="M001629"></a><b>Thread.exclusive { block }   => obj
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Wraps a block in Thread.critical, restoring the original value upon exit
from the critical section, and returns the value of the block.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001629_source')" id="l_M001629_source">show</a>
                        
                    </p>
                    <div id="M001629_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File prelude.rb, line 26</span>
26:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">exclusive</span>
27:     <span class="ruby-constant">MUTEX_FOR_THREAD_EXCLUSIVE</span>.<span class="ruby-identifier">synchronize</span>{
28:       <span class="ruby-keyword kw">yield</span>
29:     }
30:   <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001568">
                    
                    <a name="M001568"></a><b>Thread.exit   &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Terminates the currently running thread and schedules another thread to be
run. If this thread is already marked to be killed, <tt>exit</tt> returns
the <tt>Thread</tt>. If this is the main thread, or the last thread, exit
the process.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001568_source')" id="l_M001568_source">show</a>
                        
                    </p>
                    <div id="M001568_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_exit(void)
{
    return rb_thread_kill(GET_THREAD()-&gt;self);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001563">
                    
                    <a name="M001563"></a><b>Thread.start([args]*) {|args| block }   &rarr; thread
Thread.fork([args]*) {|args| block }    &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Basically the same as <tt>Thread::new</tt>. However, if class
<tt>Thread</tt> is subclassed, then calling <tt>start</tt> in that subclass
will not invoke the subclass&#8217;s <tt>initialize</tt> method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001563_source')" id="l_M001563_source">show</a>
                        
                    </p>
                    <div id="M001563_source" class="dyn-source">
                        <pre>static VALUE
thread_start(VALUE klass, VALUE args)
{
    return thread_create_core(rb_thread_alloc(klass), args, 0);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001567">
                    
                    <a name="M001567"></a><b>Thread.kill(thread)   &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Causes the given <em>thread</em> to exit (see <tt>Thread::exit</tt>).
</p>
<pre>
   count = 0
   a = Thread.new { loop { count += 1 } }
   sleep(0.1)       #=&gt; 0
   Thread.kill(a)   #=&gt; #&lt;Thread:0x401b3d30 dead&gt;
   count            #=&gt; 93947
   a.alive?         #=&gt; false
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001567_source')" id="l_M001567_source">show</a>
                        
                    </p>
                    <div id="M001567_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_kill(VALUE obj, VALUE th)
{
    return rb_thread_kill(th);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001570">
                    
                    <a name="M001570"></a><b>Thread.list   &rarr; array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns an array of <tt>Thread</tt> objects for all threads that are either
runnable or stopped.
</p>
<pre>
   Thread.new { sleep(200) }
   Thread.new { 1000000.times {|i| i*i } }
   Thread.new { Thread.stop }
   Thread.list.each {|t| p t}
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   #&lt;Thread:0x401b3e84 sleep&gt;
   #&lt;Thread:0x401b3f38 run&gt;
   #&lt;Thread:0x401b3fb0 sleep&gt;
   #&lt;Thread:0x401bdf4c run&gt;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001570_source')" id="l_M001570_source">show</a>
                        
                    </p>
                    <div id="M001570_source" class="dyn-source">
                        <pre>VALUE
rb_thread_list(void)
{
    VALUE ary = rb_ary_new();
    st_foreach(GET_THREAD()-&gt;vm-&gt;living_threads, thread_list_i, ary);
    return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001564">
                    
                    <a name="M001564"></a><b>Thread.main   &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the main thread.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001564_source')" id="l_M001564_source">show</a>
                        
                    </p>
                    <div id="M001564_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_s_main(VALUE klass)
{
    return rb_thread_main();
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001569">
                    
                    <a name="M001569"></a><b>Thread.pass   &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Invokes the thread scheduler to pass execution to another thread.
</p>
<pre>
   a = Thread.new { print &quot;a&quot;; Thread.pass;
                    print &quot;b&quot;; Thread.pass;
                    print &quot;c&quot; }
   b = Thread.new { print &quot;x&quot;; Thread.pass;
                    print &quot;y&quot;; Thread.pass;
                    print &quot;z&quot; }
   a.join
   b.join
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   axbycz
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001569_source')" id="l_M001569_source">show</a>
                        
                    </p>
                    <div id="M001569_source" class="dyn-source">
                        <pre>static VALUE
thread_s_pass(VALUE klass)
{
    rb_thread_schedule();
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001562">
                    
                    <a name="M001562"></a><b>Thread.start([args]*) {|args| block }   &rarr; thread
Thread.fork([args]*) {|args| block }    &rarr; thread
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Basically the same as <tt>Thread::new</tt>. However, if class
<tt>Thread</tt> is subclassed, then calling <tt>start</tt> in that subclass
will not invoke the subclass&#8217;s <tt>initialize</tt> method.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001562_source')" id="l_M001562_source">show</a>
                        
                    </p>
                    <div id="M001562_source" class="dyn-source">
                        <pre>static VALUE
thread_start(VALUE klass, VALUE args)
{
    return thread_create_core(rb_thread_alloc(klass), args, 0);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001566">
                    
                    <a name="M001566"></a><b>Thread.stop   &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Stops execution of the current thread, putting it into a
``sleep&#8217;&#8217; state, and schedules execution of another thread.
</p>
<pre>
   a = Thread.new { print &quot;a&quot;; Thread.stop; print &quot;c&quot; }
   Thread.pass
   print &quot;b&quot;
   a.run
   a.join
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   abc
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001566_source')" id="l_M001566_source">show</a>
                        
                    </p>
                    <div id="M001566_source" class="dyn-source">
                        <pre>VALUE
rb_thread_stop(void)
{
    if (rb_thread_alone()) {
        rb_raise(rb_eThreadError,
                 &quot;stopping only thread\n\tnote: use sleep to stop forever&quot;);
    }
    rb_thread_sleep_deadly();
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M001584">
                    
                    <a name="M001584"></a><b>thr[sym]   &rarr; obj or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Attribute Reference&#8212;Returns the value of a thread-local variable,
using either a symbol or a string name. If the specified variable does not
exist, returns <tt>nil</tt>.
</p>
<pre>
   a = Thread.new { Thread.current[&quot;name&quot;] = &quot;A&quot;; Thread.stop }
   b = Thread.new { Thread.current[:name]  = &quot;B&quot;; Thread.stop }
   c = Thread.new { Thread.current[&quot;name&quot;] = &quot;C&quot;; Thread.stop }
   Thread.list.each {|x| puts &quot;#{x.inspect}: #{x[:name]}&quot; }
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   #&lt;Thread:0x401b3b3c sleep&gt;: C
   #&lt;Thread:0x401b3bc8 sleep&gt;: B
   #&lt;Thread:0x401b3c68 sleep&gt;: A
   #&lt;Thread:0x401bdf4c run&gt;:
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001584_source')" id="l_M001584_source">show</a>
                        
                    </p>
                    <div id="M001584_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_aref(VALUE thread, VALUE id)
{
    return rb_thread_local_aref(thread, rb_to_id(id));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001585">
                    
                    <a name="M001585"></a><b>thr[sym] = obj   &rarr; obj
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Attribute Assignment&#8212;Sets or creates the value of a thread-local
variable, using either a symbol or a string. See also <tt>Thread#[]</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001585_source')" id="l_M001585_source">show</a>
                        
                    </p>
                    <div id="M001585_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_aset(VALUE self, VALUE id, VALUE val)
{
    return rb_thread_local_aset(self, rb_to_id(id), val);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001593">
                    
                    <a name="M001593"></a><b>thr.abort_on_exception   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the status of the thread-local ``abort on exception&#8217;&#8217;
condition for <em>thr</em>. The default is <tt>false</tt>. See also
<tt>Thread::<a href="Thread.html#M001571">abort_on_exception</a>=</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001593_source')" id="l_M001593_source">show</a>
                        
                    </p>
                    <div id="M001593_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_abort_exc(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);
    return th-&gt;abort_on_exception ? Qtrue : Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001594">
                    
                    <a name="M001594"></a><b>thr.abort_on_exception= boolean   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
When set to <tt>true</tt>, causes all threads (including the main program)
to abort if an exception is raised in <em>thr</em>. The process will
effectively <tt>exit(0)</tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001594_source')" id="l_M001594_source">show</a>
                        
                    </p>
                    <div id="M001594_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_abort_exc_set(VALUE thread, VALUE val)
{
    rb_thread_t *th;
    rb_secure(4);

    GetThreadPtr(thread, th);
    th-&gt;abort_on_exception = RTEST(val);
    return val;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001610">
                    
                    <a name="M001610"></a><b>thr.add_trace_func(proc)    &rarr; proc
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Adds <em>proc</em> as a handler for tracing. See <tt><a
href="Thread.html#M001609">Thread#set_trace_func</a></tt> and <tt><a
href="Thread.html#M001609">set_trace_func</a></tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001610_source')" id="l_M001610_source">show</a>
                        
                    </p>
                    <div id="M001610_source" class="dyn-source">
                        <pre>static VALUE
thread_add_trace_func_m(VALUE obj, VALUE trace)
{
    rb_thread_t *th;
    GetThreadPtr(obj, th);
    thread_add_trace_func(th, trace);
    return trace;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001591">
                    
                    <a name="M001591"></a><b>thr.alive?   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if <em>thr</em> is running or sleeping.
</p>
<pre>
   thr = Thread.new { }
   thr.join                #=&gt; #&lt;Thread:0x401b3fb0 dead&gt;
   Thread.current.alive?   #=&gt; true
   thr.alive?              #=&gt; false
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001591_source')" id="l_M001591_source">show</a>
                        
                    </p>
                    <div id="M001591_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_alive_p(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);

    if (rb_threadptr_dead(th))
        return Qfalse;
    return Qtrue;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001597">
                    
                    <a name="M001597"></a><b>thr.backtrace    &rarr; array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the current back trace of the <em>thr</em>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001597_source')" id="l_M001597_source">show</a>
                        
                    </p>
                    <div id="M001597_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_backtrace_m(VALUE thval)
{
    return rb_thread_backtrace(thval);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001581">
                    
                    <a name="M001581"></a><b>thr.exit        &rarr; thr or nil
thr.kill        &rarr; thr or nil
thr.terminate   &rarr; thr or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Terminates <em>thr</em> and schedules another thread to be run. If this
thread is already marked to be killed, <tt>exit</tt> returns the
<tt>Thread</tt>. If this is the main thread, or the last thread, exits the
process.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001581_source')" id="l_M001581_source">show</a>
                        
                    </p>
                    <div id="M001581_source" class="dyn-source">
                        <pre>VALUE
rb_thread_kill(VALUE thread)
{
    rb_thread_t *th;

    GetThreadPtr(thread, th);

    if (th != GET_THREAD() &amp;&amp; th-&gt;safe_level &lt; 4) {
        rb_secure(4);
    }
    if (th-&gt;status == THREAD_TO_KILL || th-&gt;status == THREAD_KILLED) {
        return thread;
    }
    if (th == th-&gt;vm-&gt;main_thread) {
        rb_exit(EXIT_SUCCESS);
    }

    thread_debug(&quot;rb_thread_kill: %p (%p)\n&quot;, (void *)th, (void *)th-&gt;thread_id);

    rb_threadptr_interrupt(th);
    th-&gt;thrown_errinfo = eKillSignal;
    th-&gt;status = THREAD_TO_KILL;

    return thread;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001596">
                    
                    <a name="M001596"></a><b>thr.group   &rarr; thgrp or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the <tt>ThreadGroup</tt> which contains <em>thr</em>, or nil if the
thread is not a member of any group.
</p>
<pre>
   Thread.main.group   #=&gt; #&lt;ThreadGroup:0x4029d914&gt;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001596_source')" id="l_M001596_source">show</a>
                        
                    </p>
                    <div id="M001596_source" class="dyn-source">
                        <pre>VALUE
rb_thread_group(VALUE thread)
{
    rb_thread_t *th;
    VALUE group;
    GetThreadPtr(thread, th);
    group = th-&gt;thgroup;

    if (!group) {
        group = Qnil;
    }
    return group;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001598">
                    
                    <a name="M001598"></a><b>thr.inspect   &rarr; string
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Dump the name, id, and status of <em>thr</em> to a string.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001598_source')" id="l_M001598_source">show</a>
                        
                    </p>
                    <div id="M001598_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_inspect(VALUE thread)
{
    const char *cname = rb_obj_classname(thread);
    rb_thread_t *th;
    const char *status;
    VALUE str;

    GetThreadPtr(thread, th);
    status = thread_status_name(th-&gt;status);
    str = rb_sprintf(&quot;#&lt;%s:%p %s&gt;&quot;, cname, (void *)thread, status);
    OBJ_INFECT(str, thread);

    return str;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001577">
                    
                    <a name="M001577"></a><b>thr.join          &rarr; thr
thr.join(limit)   &rarr; thr
</b>
                    
                </div>
                
                <div class="description">
                  <p>
The calling thread will suspend execution and run <em>thr</em>. Does not
return until <em>thr</em> exits or until <em>limit</em> seconds have
passed. If the time limit expires, <tt>nil</tt> will be returned, otherwise
<em>thr</em> is returned.
</p>
<p>
Any threads not joined will be killed when the main program exits. If
<em>thr</em> had previously raised an exception and the <tt><a
href="Thread.html#M001571">abort_on_exception</a></tt> and <tt>$DEBUG</tt>
flags are not set (so the exception has not yet been processed) it will be
processed at this time.
</p>
<pre>
   a = Thread.new { print &quot;a&quot;; sleep(10); print &quot;b&quot;; print &quot;c&quot; }
   x = Thread.new { print &quot;x&quot;; Thread.pass; print &quot;y&quot;; print &quot;z&quot; }
   x.join # Let x thread finish, a will be killed on exit.
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   axyz
</pre>
<p>
The following example illustrates the <em>limit</em> parameter.
</p>
<pre>
   y = Thread.new { 4.times { sleep 0.1; puts 'tick... ' }}
   puts &quot;Waiting&quot; until y.join(0.15)
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   tick...
   Waiting
   tick...
   Waitingtick...

   tick...
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001577_source')" id="l_M001577_source">show</a>
                        
                    </p>
                    <div id="M001577_source" class="dyn-source">
                        <pre>static VALUE
thread_join_m(int argc, VALUE *argv, VALUE self)
{
    rb_thread_t *target_th;
    double delay = DELAY_INFTY;
    VALUE limit;

    GetThreadPtr(self, target_th);

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;limit);
    if (!NIL_P(limit)) {
        delay = rb_num2dbl(limit);
    }

    return thread_join(target_th, delay);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001586">
                    
                    <a name="M001586"></a><b>thr.key?(sym)   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if the given string (or symbol) exists as a
thread-local variable.
</p>
<pre>
   me = Thread.current
   me[:oliver] = &quot;a&quot;
   me.key?(:oliver)    #=&gt; true
   me.key?(:stanley)   #=&gt; false
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001586_source')" id="l_M001586_source">show</a>
                        
                    </p>
                    <div id="M001586_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_key_p(VALUE self, VALUE key)
{
    rb_thread_t *th;
    ID id = rb_to_id(key);

    GetThreadPtr(self, th);

    if (!th-&gt;local_storage) {
        return Qfalse;
    }
    if (st_lookup(th-&gt;local_storage, id, 0)) {
        return Qtrue;
    }
    return Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001587">
                    
                    <a name="M001587"></a><b>thr.keys   &rarr; array
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns an an array of the names of the thread-local variables (as
Symbols).
</p>
<pre>
   thr = Thread.new do
     Thread.current[:cat] = 'meow'
     Thread.current[&quot;dog&quot;] = 'woof'
   end
   thr.join   #=&gt; #&lt;Thread:0x401b3f10 dead&gt;
   thr.keys   #=&gt; [:dog, :cat]
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001587_source')" id="l_M001587_source">show</a>
                        
                    </p>
                    <div id="M001587_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_keys(VALUE self)
{
    rb_thread_t *th;
    VALUE ary = rb_ary_new();
    GetThreadPtr(self, th);

    if (th-&gt;local_storage) {
        st_foreach(th-&gt;local_storage, thread_keys_i, ary);
    }
    return ary;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001579">
                    
                    <a name="M001579"></a><b>thr.exit        &rarr; thr or nil
thr.kill        &rarr; thr or nil
thr.terminate   &rarr; thr or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Terminates <em>thr</em> and schedules another thread to be run. If this
thread is already marked to be killed, <tt>exit</tt> returns the
<tt>Thread</tt>. If this is the main thread, or the last thread, exits the
process.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001579_source')" id="l_M001579_source">show</a>
                        
                    </p>
                    <div id="M001579_source" class="dyn-source">
                        <pre>VALUE
rb_thread_kill(VALUE thread)
{
    rb_thread_t *th;

    GetThreadPtr(thread, th);

    if (th != GET_THREAD() &amp;&amp; th-&gt;safe_level &lt; 4) {
        rb_secure(4);
    }
    if (th-&gt;status == THREAD_TO_KILL || th-&gt;status == THREAD_KILLED) {
        return thread;
    }
    if (th == th-&gt;vm-&gt;main_thread) {
        rb_exit(EXIT_SUCCESS);
    }

    thread_debug(&quot;rb_thread_kill: %p (%p)\n&quot;, (void *)th, (void *)th-&gt;thread_id);

    rb_threadptr_interrupt(th);
    th-&gt;thrown_errinfo = eKillSignal;
    th-&gt;status = THREAD_TO_KILL;

    return thread;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001588">
                    
                    <a name="M001588"></a><b>thr.priority   &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the priority of <em>thr</em>. Default is inherited from the current
thread which creating the new thread, or zero for the initial main thread;
higher-priority thread will run more frequently than lower-priority threads
(but lower-priority threads can also run).
</p>
<p>
This is just hint for Ruby thread scheduler. It may be ignored on some
platform.
</p>
<pre>
   Thread.current.priority   #=&gt; 0
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001588_source')" id="l_M001588_source">show</a>
                        
                    </p>
                    <div id="M001588_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_priority(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);
    return INT2NUM(th-&gt;priority);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001589">
                    
                    <a name="M001589"></a><b>thr.priority= integer   &rarr; thr
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Sets the priority of <em>thr</em> to <em>integer</em>. Higher-priority
threads will run more frequently than lower-priority threads (but
lower-priority threads can also run).
</p>
<p>
This is just hint for Ruby thread scheduler. It may be ignored on some
platform.
</p>
<pre>
   count1 = count2 = 0
   a = Thread.new do
         loop { count1 += 1 }
       end
   a.priority = -1

   b = Thread.new do
         loop { count2 += 1 }
       end
   b.priority = -2
   sleep 1   #=&gt; 1
   count1    #=&gt; 622504
   count2    #=&gt; 5832
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001589_source')" id="l_M001589_source">show</a>
                        
                    </p>
                    <div id="M001589_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_priority_set(VALUE thread, VALUE prio)
{
    rb_thread_t *th;
    int priority;
    GetThreadPtr(thread, th);

    rb_secure(4);

#if USE_NATIVE_THREAD_PRIORITY
    th-&gt;priority = NUM2INT(prio);
    native_thread_apply_priority(th);
#else
    priority = NUM2INT(prio);
    if (priority &gt; RUBY_THREAD_PRIORITY_MAX) {
        priority = RUBY_THREAD_PRIORITY_MAX;
    }
    else if (priority &lt; RUBY_THREAD_PRIORITY_MIN) {
        priority = RUBY_THREAD_PRIORITY_MIN;
    }
    th-&gt;priority = priority;
    th-&gt;slice = priority;
#endif
    return INT2NUM(th-&gt;priority);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001576">
                    
                    <a name="M001576"></a><b>thr.raise
thr.raise(string)
thr.raise(exception [, string [, array]])
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Raises an exception (see <tt>Kernel::raise</tt>) from <em>thr</em>. The
caller does not have to be <em>thr</em>.
</p>
<pre>
   Thread.abort_on_exception = true
   a = Thread.new { sleep(200) }
   a.raise(&quot;Gotcha&quot;)
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   prog.rb:3: Gotcha (RuntimeError)
    from prog.rb:2:in `initialize'
    from prog.rb:2:in `new'
    from prog.rb:2
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001576_source')" id="l_M001576_source">show</a>
                        
                    </p>
                    <div id="M001576_source" class="dyn-source">
                        <pre>static VALUE
thread_raise_m(int argc, VALUE *argv, VALUE self)
{
    rb_thread_t *th;
    GetThreadPtr(self, th);
    rb_threadptr_raise(th, argc, argv);
    return Qnil;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001582">
                    
                    <a name="M001582"></a><b>thr.run   &rarr; thr
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Wakes up <em>thr</em>, making it eligible for scheduling.
</p>
<pre>
   a = Thread.new { puts &quot;a&quot;; Thread.stop; puts &quot;c&quot; }
   Thread.pass
   puts &quot;Got here&quot;
   a.run
   a.join
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   a
   Got here
   c
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001582_source')" id="l_M001582_source">show</a>
                        
                    </p>
                    <div id="M001582_source" class="dyn-source">
                        <pre>VALUE
rb_thread_run(VALUE thread)
{
    rb_thread_wakeup(thread);
    rb_thread_schedule();
    return thread;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001595">
                    
                    <a name="M001595"></a><b>thr.safe_level   &rarr; integer
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the safe level in effect for <em>thr</em>. Setting thread-local
safe levels can help when implementing sandboxes which run insecure code.
</p>
<pre>
   thr = Thread.new { $SAFE = 3; sleep }
   Thread.current.safe_level   #=&gt; 0
   thr.safe_level              #=&gt; 3
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001595_source')" id="l_M001595_source">show</a>
                        
                    </p>
                    <div id="M001595_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_safe_level(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);

    return INT2NUM(th-&gt;safe_level);
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001609">
                    
                    <a name="M001609"></a><b>thr.set_trace_func(proc)    &rarr; proc
thr.set_trace_func(nil)     &rarr; nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Establishes <em>proc</em> on <em>thr</em> as the handler for tracing, or
disables tracing if the parameter is <tt>nil</tt>. See <tt><a
href="Thread.html#M001609">set_trace_func</a></tt>.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001609_source')" id="l_M001609_source">show</a>
                        
                    </p>
                    <div id="M001609_source" class="dyn-source">
                        <pre>static VALUE
thread_set_trace_func_m(VALUE obj, VALUE trace)
{
    rb_thread_t *th;
    GetThreadPtr(obj, th);
    rb_threadptr_revmove_event_hook(th, call_trace_func);

    if (NIL_P(trace)) {
        return Qnil;
    }
    thread_add_trace_func(th, trace);
    return trace;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001590">
                    
                    <a name="M001590"></a><b>thr.status   &rarr; string, false or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns the status of <em>thr</em>: ``<tt>sleep</tt>&#8217;&#8217; if
<em>thr</em> is sleeping or waiting on I/O, ``<tt>run</tt>&#8217;&#8217; if
<em>thr</em> is executing, ``<tt>aborting</tt>&#8217;&#8217; if
<em>thr</em> is aborting, <tt>false</tt> if <em>thr</em> terminated
normally, and <tt>nil</tt> if <em>thr</em> terminated with an exception.
</p>
<pre>
   a = Thread.new { raise(&quot;die now&quot;) }
   b = Thread.new { Thread.stop }
   c = Thread.new { Thread.exit }
   d = Thread.new { sleep }
   d.kill                  #=&gt; #&lt;Thread:0x401b3678 aborting&gt;
   a.status                #=&gt; nil
   b.status                #=&gt; &quot;sleep&quot;
   c.status                #=&gt; false
   d.status                #=&gt; &quot;aborting&quot;
   Thread.current.status   #=&gt; &quot;run&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001590_source')" id="l_M001590_source">show</a>
                        
                    </p>
                    <div id="M001590_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_status(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);

    if (rb_threadptr_dead(th)) {
        if (!NIL_P(th-&gt;errinfo) &amp;&amp; !FIXNUM_P(th-&gt;errinfo)
            /* TODO */ ) {
            return Qnil;
        }
        return Qfalse;
    }
    return rb_str_new2(thread_status_name(th-&gt;status));
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001592">
                    
                    <a name="M001592"></a><b>thr.stop?   &rarr; true or false
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Returns <tt>true</tt> if <em>thr</em> is dead or sleeping.
</p>
<pre>
   a = Thread.new { Thread.stop }
   b = Thread.current
   a.stop?   #=&gt; true
   b.stop?   #=&gt; false
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001592_source')" id="l_M001592_source">show</a>
                        
                    </p>
                    <div id="M001592_source" class="dyn-source">
                        <pre>static VALUE
rb_thread_stop_p(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);

    if (rb_threadptr_dead(th))
        return Qtrue;
    if (th-&gt;status == THREAD_STOPPED || th-&gt;status == THREAD_STOPPED_FOREVER)
        return Qtrue;
    return Qfalse;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001580">
                    
                    <a name="M001580"></a><b>thr.exit        &rarr; thr or nil
thr.kill        &rarr; thr or nil
thr.terminate   &rarr; thr or nil
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Terminates <em>thr</em> and schedules another thread to be run. If this
thread is already marked to be killed, <tt>exit</tt> returns the
<tt>Thread</tt>. If this is the main thread, or the last thread, exits the
process.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001580_source')" id="l_M001580_source">show</a>
                        
                    </p>
                    <div id="M001580_source" class="dyn-source">
                        <pre>VALUE
rb_thread_kill(VALUE thread)
{
    rb_thread_t *th;

    GetThreadPtr(thread, th);

    if (th != GET_THREAD() &amp;&amp; th-&gt;safe_level &lt; 4) {
        rb_secure(4);
    }
    if (th-&gt;status == THREAD_TO_KILL || th-&gt;status == THREAD_KILLED) {
        return thread;
    }
    if (th == th-&gt;vm-&gt;main_thread) {
        rb_exit(EXIT_SUCCESS);
    }

    thread_debug(&quot;rb_thread_kill: %p (%p)\n&quot;, (void *)th, (void *)th-&gt;thread_id);

    rb_threadptr_interrupt(th);
    th-&gt;thrown_errinfo = eKillSignal;
    th-&gt;status = THREAD_TO_KILL;

    return thread;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001578">
                    
                    <a name="M001578"></a><b>thr.value   &rarr; obj
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Waits for <em>thr</em> to complete (via <tt><a
href="Thread.html#M001577">Thread#join</a></tt>) and returns its value.
</p>
<pre>
   a = Thread.new { 2 + 2 }
   a.value   #=&gt; 4
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001578_source')" id="l_M001578_source">show</a>
                        
                    </p>
                    <div id="M001578_source" class="dyn-source">
                        <pre>static VALUE
thread_value(VALUE self)
{
    rb_thread_t *th;
    GetThreadPtr(self, th);
    thread_join(th, DELAY_INFTY);
    return th-&gt;value;
}</pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M001583">
                    
                    <a name="M001583"></a><b>thr.wakeup   &rarr; thr
</b>
                    
                </div>
                
                <div class="description">
                  <p>
Marks <em>thr</em> as eligible for scheduling (it may still remain blocked
on I/O, however). Does not invoke the scheduler (see <tt><a
href="Thread.html#M001582">Thread#run</a></tt>).
</p>
<pre>
   c = Thread.new { Thread.stop; puts &quot;hey!&quot; }
   c.wakeup
</pre>
<p>
<em>produces:</em>
</p>
<pre>
   hey!
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M001583_source')" id="l_M001583_source">show</a>
                        
                    </p>
                    <div id="M001583_source" class="dyn-source">
                        <pre>VALUE
rb_thread_wakeup(VALUE thread)
{
    rb_thread_t *th;
    GetThreadPtr(thread, th);

    if (th-&gt;status == THREAD_KILLED) {
        rb_raise(rb_eThreadError, &quot;killed thread&quot;);
    }
    rb_threadptr_ready(th);
    if (th-&gt;status != THREAD_TO_KILL) {
        th-&gt;status = THREAD_RUNNABLE;
    }
    return thread;
}</pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    