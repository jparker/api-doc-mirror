<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>REXML::Text</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            REXML::Text 
            
                <span class="parent">&lt; 
                    
                    Child
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rexml/text_rb.html">lib/rexml/text.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
Represents text nodes in an XML document
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M002781"><<</a>,</li>
                
                <li><a href="#M002782"><=></a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M002777">check</a>,</li>
                
                <li><a href="#M002780">clone</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M002783">doctype</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M002779">empty?</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M002789">indent_text</a>,</li>
                
                <li><a href="#M002785">inspect</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M002775">new</a>,</li>
                
                <li><a href="#M002778">node_type</a>,</li>
                
                <li><a href="#M002794">normalize</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M002776">parent=</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M002793">read_with_substitution</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M002784">to_s</a></li>
                
            </ul>
        </dd>
    
        <dt>U</dt>
        <dd>
            <ul>
                
                <li><a href="#M002795">unnormalize</a></li>
                
            </ul>
        </dd>
    
        <dt>V</dt>
        <dd>
            <ul>
                
                <li><a href="#M002786">value</a>,</li>
                
                <li><a href="#M002787">value=</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M002788">wrap</a>,</li>
                
                <li><a href="#M002790">write</a>,</li>
                
                <li><a href="#M002792">write_with_substitution</a></li>
                
            </ul>
        </dd>
    
        <dt>X</dt>
        <dd>
            <ul>
                
                <li><a href="#M002791">xpath</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../Kernel.html">Kernel</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    
    <div class="sectiontitle">Constants</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class="attr-name">SPECIALS</td>
            <td>=</td>
            <td class="attr-value">[ /&amp;(?!#?[\w-]+;)/u, /&lt;/u, /&gt;/u, /&quot;/u, /'/u, /\r/u ]</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
The order in which the substitutions occur
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SUBSTITUTES</td>
            <td>=</td>
            <td class="attr-value">['&amp;amp;', '&amp;lt;', '&amp;gt;', '&amp;quot;', '&amp;apos;', '&amp;#13;']</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SLAICEPS</td>
            <td>=</td>
            <td class="attr-value">[ '&lt;', '&gt;', '&quot;', &quot;'&quot;, '&amp;' ]</td>
        </tr>
        
        <tr valign='top'>
            <td>&nbsp;</td>
            <td colspan="2" class="attr-desc"><p>
Characters which are substituted in written strings
</p>
</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">SETUTITSBUS</td>
            <td>=</td>
            <td class="attr-value">[ /&amp;lt;/u, /&amp;gt;/u, /&amp;quot;/u, /&amp;apos;/u, /&amp;amp;/u ]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">NEEDS_A_SECOND_CHECK</td>
            <td>=</td>
            <td class="attr-value">/(&lt;|&amp;((#{Entity::NAME});|(#0*((?:\d+)|(?:x[a-fA-F0-9]+)));)?)/um</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">NUMERICENTITY</td>
            <td>=</td>
            <td class="attr-value">/&amp;#0*((?:\d+)|(?:x[a-fA-F0-9]+));/</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">VALID_CHAR</td>
            <td>=</td>
            <td class="attr-value">[       0x9, 0xA, 0xD,       (0x20..0xD7FF),       (0xE000..0xFFFD),       (0x10000..0x10FFFF)     ]</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">VALID_XML_CHARS</td>
            <td>=</td>
            <td class="attr-value">Regexp.new('^['+         VALID_CHAR.map { |item|           case item           when Fixnum             [item].pack('U').force_encoding('utf-8')           when Range             [item.first, '-'.ord, item.last].pack('UUU').force_encoding('utf-8')           end         }.join +       ']*$')</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">VALID_XML_CHARS</td>
            <td>=</td>
            <td class="attr-value">/^(            [\x09\x0A\x0D\x20-\x7E]            # ASCII          | [\xC2-\xDF][\x80-\xBF]             # non-overlong 2-byte          |  \xE0[\xA0-\xBF][\x80-\xBF]        # excluding overlongs          | [\xE1-\xEC\xEE][\x80-\xBF]{2}      # straight 3-byte          |  \xEF[\x80-\xBE]{2}                #          |  \xEF\xBF[\x80-\xBD]               # excluding U+fffe and U+ffff          |  \xED[\x80-\x9F][\x80-\xBF]        # excluding surrogates          |  \xF0[\x90-\xBF][\x80-\xBF]{2}     # planes 1-3          | [\xF1-\xF3][\x80-\xBF]{3}          # planes 4-15          |  \xF4[\x80-\x8F][\x80-\xBF]{2}     # plane 16        )*$/nx;</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">REFERENCE</td>
            <td>=</td>
            <td class="attr-value">/#{Entity::REFERENCE}/</td>
        </tr>
        
        
        <tr valign='top'>
            <td class="attr-name">EREFERENCE</td>
            <td>=</td>
            <td class="attr-value">/&amp;(?!#{Entity::NAME};)/</td>
        </tr>
        
        
    </table>
    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>raw</td>
            <td class='attr-desc'><p>
If <tt>raw</tt> is true, then <a href="../REXML.html">REXML</a> leaves the
value alone
</p></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M002777">
                    
                    <a name="M002777"></a><b>check</b>(string, pattern, doctype)
                    
                </div>
                
                <div class="description">
                  <p>
check for illegal characters
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002777_source')" id="l_M002777_source">show</a>
                        
                    </p>
                    <div id="M002777_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 128</span>
128:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span>.<span class="ruby-identifier">check</span> <span class="ruby-identifier">string</span>, <span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">doctype</span>
129: 
130:       <span class="ruby-comment cmt"># illegal anywhere</span>
131:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string</span> <span class="ruby-operator">!~</span> <span class="ruby-constant">VALID_XML_CHARS</span>
132:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">String</span>.<span class="ruby-identifier">method_defined?</span> <span class="ruby-identifier">:encode</span>
133:           <span class="ruby-identifier">string</span>.<span class="ruby-identifier">chars</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
134:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">ord</span>
135:             <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">VALID_CHAR</span>
136:             <span class="ruby-keyword kw">else</span>
137:               <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal character #{c.inspect} in raw string \&quot;#{string}\&quot;&quot;</span>
138:             <span class="ruby-keyword kw">end</span>
139:           <span class="ruby-keyword kw">end</span>
140:         <span class="ruby-keyword kw">else</span>
141:           <span class="ruby-identifier">string</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/[\x00-\x7F]|[\x80-\xBF][\xC0-\xF0]*|[\xC0-\xF0]/n</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
142:             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'U'</span>)
143:             <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">VALID_CHAR</span>
144:             <span class="ruby-keyword kw">else</span>
145:               <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal character #{c.inspect} in raw string \&quot;#{string}\&quot;&quot;</span>
146:             <span class="ruby-keyword kw">end</span>
147:           <span class="ruby-keyword kw">end</span>
148:         <span class="ruby-keyword kw">end</span>
149:       <span class="ruby-keyword kw">end</span>
150: 
151:       <span class="ruby-comment cmt"># context sensitive</span>
152:       <span class="ruby-identifier">string</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>) <span class="ruby-keyword kw">do</span>
153:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$1</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">?;</span>
154:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal character '#{$1}' in raw string \&quot;#{string}\&quot;&quot;</span>
155:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">$1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?&amp;</span>
156:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$5</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">$5</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?#</span>
157:             <span class="ruby-keyword kw">case</span> (<span class="ruby-identifier">$5</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">$5</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">$5</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span>)
158:             <span class="ruby-keyword kw">when</span> <span class="ruby-operator">*</span><span class="ruby-constant">VALID_CHAR</span>
159:             <span class="ruby-keyword kw">else</span>
160:               <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal character '#{$1}' in raw string \&quot;#{string}\&quot;&quot;</span>
161:             <span class="ruby-keyword kw">end</span>
162:           <span class="ruby-comment cmt"># FIXME: below can't work but this needs API change.</span>
163:           <span class="ruby-comment cmt"># elsif @parent and $3 and !SUBSTITUTES.include?($1)</span>
164:           <span class="ruby-comment cmt">#   if !doctype or !doctype.entities.has_key?($3)</span>
165:           <span class="ruby-comment cmt">#     raise &quot;Undeclared entity '#{$1}' in raw string \&quot;#{string}\&quot;&quot;</span>
166:           <span class="ruby-comment cmt">#   end</span>
167:           <span class="ruby-keyword kw">end</span>
168:         <span class="ruby-keyword kw">end</span>
169:       <span class="ruby-keyword kw">end</span>
170:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002775">
                    
                    <a name="M002775"></a><b>new</b>(arg, respect_whitespace=false, parent=nil, raw=nil, entity_filter=nil, illegal=NEEDS_A_SECOND_CHECK )
                    
                </div>
                
                <div class="description">
                  <p>
Constructor <tt>arg</tt> if a <a href="../String.html">String</a>, the
content is set to the <a href="../String.html">String</a>. If a <a
href="Text.html">Text</a>, the object is shallowly cloned.
</p>
<p>
<tt>respect_whitespace</tt> (boolean, false) if true, whitespace is
respected
</p>
<p>
<tt>parent</tt> (nil) if this is a <a href="Parent.html">Parent</a> object,
the parent will be set to this.
</p>
<p>
<tt>raw</tt> (nil) This argument can be given three values. If true, then
the value of used to construct this object is expected to contain no
unescaped XML markup, and <a href="../REXML.html">REXML</a> will not change
the text. If this value is false, the string may contain any characters,
and <a href="../REXML.html">REXML</a> will escape any and all defined
entities whose values are contained in the text. If this value is nil (the
default), then the raw value of the parent will be used as the raw value
for this node. If there is no raw value for the parent, and no value is
supplied, the default is false. Use this field if you have entities defined
for some text, and you don&#8217;t want <a href="../REXML.html">REXML</a>
to escape that text in output.
</p>
<pre>
  Text.new( &quot;&lt;&amp;&quot;, false, nil, false ) #-&gt; &quot;&amp;lt;&amp;amp;&quot;
  Text.new( &quot;&amp;lt;&amp;amp;&quot;, false, nil, false ) #-&gt; &quot;&amp;amp;lt;&amp;amp;amp;&quot;
  Text.new( &quot;&lt;&amp;&quot;, false, nil, true )  #-&gt; Parse exception
  Text.new( &quot;&amp;lt;&amp;amp;&quot;, false, nil, true )  #-&gt; &quot;&amp;lt;&amp;amp;&quot;
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;
  # and that the entity    &quot;r&quot; is defined to be &quot;russell&quot;
  Text.new( &quot;sean russell&quot; )          #-&gt; &quot;&amp;s; &amp;r;&quot;
  Text.new( &quot;sean russell&quot;, false, nil, true ) #-&gt; &quot;sean russell&quot;
</pre>
<p>
<tt>entity_filter</tt> (nil) This can be an array of entities to match in
the supplied text. This argument is only useful if <tt>raw</tt> is set to
false.
</p>
<pre>
  Text.new( &quot;sean russell&quot;, false, nil, false, [&quot;s&quot;] ) #-&gt; &quot;&amp;s; russell&quot;
  Text.new( &quot;sean russell&quot;, false, nil, true, [&quot;s&quot;] ) #-&gt; &quot;sean russell&quot;
</pre>
<p>
In the last example, the <tt>entity_filter</tt> argument is ignored.
</p>
<p>
<tt>illegal</tt> INTERNAL USE ONLY
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002775_source')" id="l_M002775_source">show</a>
                        
                    </p>
                    <div id="M002775_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 92</span>
 92:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">respect_whitespace</span>=<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">parent</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">raw</span>=<span class="ruby-keyword kw">nil</span>,
 93:       <span class="ruby-identifier">entity_filter</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-constant">NEEDS_A_SECOND_CHECK</span> )
 94: 
 95:       <span class="ruby-ivar">@raw</span> = <span class="ruby-keyword kw">false</span>
 96:       <span class="ruby-ivar">@parent</span> = <span class="ruby-keyword kw">nil</span>
 97: 
 98:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parent</span>
 99:         <span class="ruby-keyword kw">super</span>( <span class="ruby-identifier">parent</span> )
100:         <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">raw</span>
101:       <span class="ruby-keyword kw">end</span>
102: 
103:       <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">raw</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">nil?</span>
104:       <span class="ruby-ivar">@entity_filter</span> = <span class="ruby-identifier">entity_filter</span>
105:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-keyword kw">nil</span>
106: 
107:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">String</span>
108:         <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">clone</span>
109:         <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">squeeze!</span>(<span class="ruby-value str">&quot; \n\t&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">respect_whitespace</span>
110:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Text</span>
111:         <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>
112:         <span class="ruby-ivar">@raw</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">raw</span>
113:       <span class="ruby-keyword kw">elsif</span>
114:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Illegal argument of type #{arg.type} for Text constructor (#{arg})&quot;</span>
115:       <span class="ruby-keyword kw">end</span>
116: 
117:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
118: 
119:       <span class="ruby-constant">Text</span>.<span class="ruby-identifier">check</span>(<span class="ruby-ivar">@string</span>, <span class="ruby-identifier">illegal</span>, <span class="ruby-identifier">doctype</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@raw</span>
120:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002794">
                    
                    <a name="M002794"></a><b>normalize</b>( input, doctype=nil, entity_filter=nil )
                    
                </div>
                
                <div class="description">
                  <p>
Escapes all possible entities
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002794_source')" id="l_M002794_source">show</a>
                        
                    </p>
                    <div id="M002794_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 360</span>
360:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">normalize</span>( <span class="ruby-identifier">input</span>, <span class="ruby-identifier">doctype</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">entity_filter</span>=<span class="ruby-keyword kw">nil</span> )
361:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">to_s</span>
362:       <span class="ruby-comment cmt"># Doing it like this rather than in a loop improves the speed</span>
363:       <span class="ruby-comment cmt">#copy = copy.gsub( EREFERENCE, '&amp;amp;' )</span>
364:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-value str">&quot;&amp;&quot;</span>, <span class="ruby-value str">&quot;&amp;amp;&quot;</span> )
365:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doctype</span>
366:         <span class="ruby-comment cmt"># Replace all ampersands that aren't part of an entity</span>
367:         <span class="ruby-identifier">doctype</span>.<span class="ruby-identifier">entities</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity</span><span class="ruby-operator">|</span>
368:           <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span>,
369:             <span class="ruby-node">&quot;&amp;#{entity.name};&quot;</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span> <span class="ruby-keyword kw">and</span>
370:               <span class="ruby-keyword kw">not</span>( <span class="ruby-identifier">entity_filter</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">entity_filter</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">entity</span>) )
371:         <span class="ruby-keyword kw">end</span>
372:       <span class="ruby-keyword kw">else</span>
373:         <span class="ruby-comment cmt"># Replace all ampersands that aren't part of an entity</span>
374:         <span class="ruby-constant">DocType</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_ENTITIES</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entity</span><span class="ruby-operator">|</span>
375:           <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">entity</span>.<span class="ruby-identifier">value</span>, <span class="ruby-node">&quot;&amp;#{entity.name};&quot;</span> )
376:         <span class="ruby-keyword kw">end</span>
377:       <span class="ruby-keyword kw">end</span>
378:       <span class="ruby-identifier">copy</span>
379:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002793">
                    
                    <a name="M002793"></a><b>read_with_substitution</b>( input, illegal=nil )
                    
                </div>
                
                <div class="description">
                  <p>
Reads text, substituting entities
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002793_source')" id="l_M002793_source">show</a>
                        
                    </p>
                    <div id="M002793_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 334</span>
334:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">read_with_substitution</span>( <span class="ruby-identifier">input</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-keyword kw">nil</span> )
335:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">clone</span>
336: 
337:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">copy</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">illegal</span>
338:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ParseException</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;malformed text: Illegal character #$&amp; in \&quot;#{copy}\&quot;&quot;</span> )
339:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">illegal</span>
340: 
341:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
342:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">include?</span> <span class="ruby-operator">?</span><span class="ruby-operator">&amp;</span>
343:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">0</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">0</span>] )
344:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">1</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">1</span>] )
345:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">2</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">2</span>] )
346:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">3</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">3</span>] )
347:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SETUTITSBUS</span>[<span class="ruby-value">4</span>], <span class="ruby-constant">SLAICEPS</span>[<span class="ruby-value">4</span>] )
348:         <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-regexp re">/&amp;#0*((?:\d+)|(?:x[a-f0-9]+));/</span> ) {
349:           <span class="ruby-identifier">m</span>=<span class="ruby-identifier">$1</span>
350:           <span class="ruby-comment cmt">#m='0' if m==''</span>
351:           <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;0#{m}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span>
352:           [<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">m</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
353:         }
354:       <span class="ruby-keyword kw">end</span>
355:       <span class="ruby-identifier">copy</span>
356:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002795">
                    
                    <a name="M002795"></a><b>unnormalize</b>( string, doctype=nil, filter=nil, illegal=nil )
                    
                </div>
                
                <div class="description">
                  <p>
Unescapes all possible entities
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002795_source')" id="l_M002795_source">show</a>
                        
                    </p>
                    <div id="M002795_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 382</span>
382:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">unnormalize</span>( <span class="ruby-identifier">string</span>, <span class="ruby-identifier">doctype</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">filter</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">illegal</span>=<span class="ruby-keyword kw">nil</span> )
383:       <span class="ruby-identifier">string</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> ).<span class="ruby-identifier">gsub</span>( <span class="ruby-constant">REFERENCE</span> ) {
384:         <span class="ruby-identifier">ref</span> = <span class="ruby-identifier">$&amp;</span>
385:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ref</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?#</span>
386:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ref</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?x</span>
387:             [<span class="ruby-identifier">ref</span>[<span class="ruby-value">3</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
388:           <span class="ruby-keyword kw">else</span>
389:             [<span class="ruby-identifier">ref</span>[<span class="ruby-value">2</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'U*'</span>)
390:           <span class="ruby-keyword kw">end</span>
391:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ref</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'&amp;amp;'</span>
392:           <span class="ruby-value str">'&amp;'</span>
393:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">filter</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">include?</span>( <span class="ruby-identifier">ref</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>] )
394:           <span class="ruby-identifier">ref</span>
395:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">doctype</span>
396:           <span class="ruby-identifier">doctype</span>.<span class="ruby-identifier">entity</span>( <span class="ruby-identifier">ref</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>] ) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">ref</span>
397:         <span class="ruby-keyword kw">else</span>
398:           <span class="ruby-identifier">entity_value</span> = <span class="ruby-constant">DocType</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_ENTITIES</span>[ <span class="ruby-identifier">ref</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>] ]
399:           <span class="ruby-identifier">entity_value</span> <span class="ruby-value">? </span><span class="ruby-identifier">entity_value</span>.<span class="ruby-identifier">value</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ref</span>
400:         <span class="ruby-keyword kw">end</span>
401:       }
402:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M002781">
                    
                    <a name="M002781"></a><b>&lt;&lt;</b>( to_append )
                    
                </div>
                
                <div class="description">
                  <p>
Appends text to this text node. The text is appended in the <tt>raw</tt>
mode of this text node.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002781_source')" id="l_M002781_source">show</a>
                        
                    </p>
                    <div id="M002781_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 188</span>
188:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>( <span class="ruby-identifier">to_append</span> )
189:       <span class="ruby-ivar">@string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">to_append</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
190:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002782">
                    
                    <a name="M002782"></a><b>&lt;=&gt;</b>( other )
                    
                </div>
                
                <div class="description">
                  <p>
<tt>other</tt> a <a href="../String.html">String</a> or a <a
href="Text.html">Text</a> <tt>returns</tt> the result of (<a
href="Text.html#M002784">to_s</a> <=> arg.to_s)
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002782_source')" id="l_M002782_source">show</a>
                        
                    </p>
                    <div id="M002782_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 195</span>
195:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;=&gt;</span>( <span class="ruby-identifier">other</span> )
196:       <span class="ruby-identifier">to_s</span>() <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_s</span>
197:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002780">
                    
                    <a name="M002780"></a><b>clone</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002780_source')" id="l_M002780_source">show</a>
                        
                    </p>
                    <div id="M002780_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 181</span>
181:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>
182:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Text</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)
183:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002783">
                    
                    <a name="M002783"></a><b>doctype</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002783_source')" id="l_M002783_source">show</a>
                        
                    </p>
                    <div id="M002783_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 199</span>
199:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">doctype</span>
200:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@parent</span>
201:         <span class="ruby-identifier">doc</span> = <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">document</span>
202:         <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">doctype</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>
203:       <span class="ruby-keyword kw">end</span>
204:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002779">
                    
                    <a name="M002779"></a><b>empty?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002779_source')" id="l_M002779_source">show</a>
                        
                    </p>
                    <div id="M002779_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 176</span>
176:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
177:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>
178:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002789">
                    
                    <a name="M002789"></a><b>indent_text</b>(string, level=1, style=&quot;\t&quot;, indentfirstline=true)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002789_source')" id="l_M002789_source">show</a>
                        
                    </p>
                    <div id="M002789_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 274</span>
274:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">indent_text</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">level</span>=<span class="ruby-value">1</span>, <span class="ruby-identifier">style</span>=<span class="ruby-value str">&quot;\t&quot;</span>, <span class="ruby-identifier">indentfirstline</span>=<span class="ruby-keyword kw">true</span>)
275:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">level</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
276:       <span class="ruby-identifier">new_string</span> = <span class="ruby-value str">''</span>
277:       <span class="ruby-identifier">string</span>.<span class="ruby-identifier">each_line</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
278:         <span class="ruby-identifier">indent_string</span> = <span class="ruby-identifier">style</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">level</span>
279:         <span class="ruby-identifier">new_line</span> = (<span class="ruby-identifier">indent_string</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">line</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/[\s]+$/</span>,<span class="ruby-value str">''</span>)
280:         <span class="ruby-identifier">new_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_line</span>
281:       }
282:       <span class="ruby-identifier">new_string</span>.<span class="ruby-identifier">strip!</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">indentfirstline</span>
283:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new_string</span>
284:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002785">
                    
                    <a name="M002785"></a><b>inspect</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002785_source')" id="l_M002785_source">show</a>
                        
                    </p>
                    <div id="M002785_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 227</span>
227:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
228:       <span class="ruby-ivar">@string</span>.<span class="ruby-identifier">inspect</span>
229:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002778">
                    
                    <a name="M002778"></a><b>node_type</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002778_source')" id="l_M002778_source">show</a>
                        
                    </p>
                    <div id="M002778_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 172</span>
172:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">node_type</span>
173:       <span class="ruby-identifier">:text</span>
174:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002776">
                    
                    <a name="M002776"></a><b>parent=</b>(parent)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002776_source')" id="l_M002776_source">show</a>
                        
                    </p>
                    <div id="M002776_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 122</span>
122:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parent=</span> <span class="ruby-identifier">parent</span>
123:       <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">parent</span>)
124:       <span class="ruby-constant">Text</span>.<span class="ruby-identifier">check</span>(<span class="ruby-ivar">@string</span>, <span class="ruby-constant">NEEDS_A_SECOND_CHECK</span>, <span class="ruby-identifier">doctype</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@raw</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@parent</span>
125:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002784">
                    
                    <a name="M002784"></a><b>to_s</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the string value of this text node. This string is always escaped,
meaning that it is a valid XML text node string, and all entities that can
be escaped, have been inserted. This method respects the entity filter set
in the constructor.
</p>
<pre>
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;, and that the
  # entity &quot;r&quot; is defined to be &quot;russell&quot;
  t = Text.new( &quot;&lt; &amp; sean russell&quot;, false, nil, false, ['s'] )
  t.to_s   #-&gt; &quot;&amp;lt; &amp;amp; &amp;s; russell&quot;
  t = Text.new( &quot;&lt; &amp; &amp;s; russell&quot;, false, nil, false )
  t.to_s   #-&gt; &quot;&amp;lt; &amp;amp; &amp;s; russell&quot;
  u = Text.new( &quot;sean russell&quot;, false, nil, true )
  u.to_s   #-&gt; &quot;sean russell&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002784_source')" id="l_M002784_source">show</a>
                        
                    </p>
                    <div id="M002784_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 220</span>
220:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
221:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@raw</span>
222:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@normalized</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@normalized</span>
223: 
224:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">normalize</span>( <span class="ruby-ivar">@string</span>, <span class="ruby-identifier">doctype</span>, <span class="ruby-ivar">@entity_filter</span> )
225:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002786">
                    
                    <a name="M002786"></a><b>value</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Returns the string value of this text. This is the text without entities,
as it might be used programmatically, or printed to the console. This
ignores the &#8216;raw&#8217; attribute setting, and any entity_filter.
</p>
<pre>
  # Assume that the entity &quot;s&quot; is defined to be &quot;sean&quot;, and that the
  # entity &quot;r&quot; is defined to be &quot;russell&quot;
  t = Text.new( &quot;&lt; &amp; sean russell&quot;, false, nil, false, ['s'] )
  t.value   #-&gt; &quot;&lt; &amp; sean russell&quot;
  t = Text.new( &quot;&lt; &amp; &amp;s; russell&quot;, false, nil, false )
  t.value   #-&gt; &quot;&lt; &amp; sean russell&quot;
  u = Text.new( &quot;sean russell&quot;, false, nil, true )
  u.value   #-&gt; &quot;sean russell&quot;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002786_source')" id="l_M002786_source">show</a>
                        
                    </p>
                    <div id="M002786_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 244</span>
244:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value</span>
245:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@unnormalized</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@unnormalized</span>
246:       <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-identifier">unnormalize</span>( <span class="ruby-ivar">@string</span>, <span class="ruby-identifier">doctype</span> )
247:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002787">
                    
                    <a name="M002787"></a><b>value=</b>( val )
                    
                </div>
                
                <div class="description">
                  <p>
Sets the contents of this text node. This expects the text to be
unnormalized. It returns self.
</p>
<pre>
  e = Element.new( &quot;a&quot; )
  e.add_text( &quot;foo&quot; )   # &lt;a&gt;foo&lt;/a&gt;
  e[0].value = &quot;bar&quot;    # &lt;a&gt;bar&lt;/a&gt;
  e[0].value = &quot;&lt;a&gt;&quot;    # &lt;a&gt;&amp;lt;a&amp;gt;&lt;/a&gt;
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002787_source')" id="l_M002787_source">show</a>
                        
                    </p>
                    <div id="M002787_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 256</span>
256:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value=</span>( <span class="ruby-identifier">val</span> )
257:       <span class="ruby-ivar">@string</span> = <span class="ruby-identifier">val</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-regexp re">/\r\n?/</span>, <span class="ruby-value str">&quot;\n&quot;</span> )
258:       <span class="ruby-ivar">@unnormalized</span> = <span class="ruby-keyword kw">nil</span>
259:       <span class="ruby-ivar">@normalized</span> = <span class="ruby-keyword kw">nil</span>
260:       <span class="ruby-ivar">@raw</span> = <span class="ruby-keyword kw">false</span>
261:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002788">
                    
                    <a name="M002788"></a><b>wrap</b>(string, width, addnewline=false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002788_source')" id="l_M002788_source">show</a>
                        
                    </p>
                    <div id="M002788_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 263</span>
263:      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">addnewline</span>=<span class="ruby-keyword kw">false</span>)
264:        <span class="ruby-comment cmt"># Recursively wrap string at width.</span>
265:        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">width</span>
266:        <span class="ruby-identifier">place</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-value str">' '</span>, <span class="ruby-identifier">width</span>) <span class="ruby-comment cmt"># Position in string with last ' ' before cutoff</span>
267:        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">addnewline</span> <span class="ruby-keyword kw">then</span>
268:          <span class="ruby-keyword kw">return</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">place</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">place</span><span class="ruby-operator">+</span><span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">width</span>)
269:        <span class="ruby-keyword kw">else</span>
270:          <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">place</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">place</span><span class="ruby-operator">+</span><span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">width</span>)
271:        <span class="ruby-keyword kw">end</span>
272:      <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002790">
                    
                    <a name="M002790"></a><b>write</b>( writer, indent=-1, transitive=false, ie_hack=false )
                    
                </div>
                
                <div class="description">
                  <h2>DEPRECATED</h2>
<p>
See <a href="Formatters.html">REXML::Formatters</a>
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002790_source')" id="l_M002790_source">show</a>
                        
                    </p>
                    <div id="M002790_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 289</span>
289:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>( <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">indent</span>=<span class="ruby-value">-1</span>, <span class="ruby-identifier">transitive</span>=<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">ie_hack</span>=<span class="ruby-keyword kw">false</span> )
290:       <span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-node">&quot;#{self.class.name}.write is deprecated.  See REXML::Formatters&quot;</span>)
291:       <span class="ruby-identifier">formatter</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">-1</span>
292:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Formatters</span><span class="ruby-operator">::</span><span class="ruby-constant">Pretty</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">indent</span> )
293:         <span class="ruby-keyword kw">else</span>
294:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Formatters</span><span class="ruby-operator">::</span><span class="ruby-constant">Default</span>.<span class="ruby-identifier">new</span>
295:         <span class="ruby-keyword kw">end</span>
296:       <span class="ruby-identifier">formatter</span>.<span class="ruby-identifier">write</span>( <span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">writer</span> )
297:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002792">
                    
                    <a name="M002792"></a><b>write_with_substitution</b>(out, input)
                    
                </div>
                
                <div class="description">
                  <p>
Writes out text, substituting special characters beforehand. <tt>out</tt>
<a href="../A.html">A</a> <a href="../String.html">String</a>, <a
href="../IO.html">IO</a>, or any other object supporting <<( <a
href="../String.html">String</a> ) <tt>input</tt> the text to substitute
and the write out
</p>
<pre>
  z=utf8.unpack(&quot;U*&quot;)
  ascOut=&quot;&quot;
  z.each{|r|
    if r &lt;  0x100
      ascOut.concat(r.chr)
    else
      ascOut.concat(sprintf(&quot;&amp;#x%x;&quot;, r))
    end
  }
  puts ascOut
</pre>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002792_source')" id="l_M002792_source">show</a>
                        
                    </p>
                    <div id="M002792_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 321</span>
321:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_with_substitution</span> <span class="ruby-identifier">out</span>, <span class="ruby-identifier">input</span>
322:       <span class="ruby-identifier">copy</span> = <span class="ruby-identifier">input</span>.<span class="ruby-identifier">clone</span>
323:       <span class="ruby-comment cmt"># Doing it like this rather than in a loop improves the speed</span>
324:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">0</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">0</span>] )
325:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">1</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">1</span>] )
326:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">2</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">2</span>] )
327:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">3</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">3</span>] )
328:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">4</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">4</span>] )
329:       <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">gsub!</span>( <span class="ruby-constant">SPECIALS</span>[<span class="ruby-value">5</span>], <span class="ruby-constant">SUBSTITUTES</span>[<span class="ruby-value">5</span>] )
330:       <span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">copy</span>
331:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002791">
                    
                    <a name="M002791"></a><b>xpath</b>()
                    
                </div>
                
                <div class="description">
                  <p>
FIXME This probably won&#8217;t work properly
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002791_source')" id="l_M002791_source">show</a>
                        
                    </p>
                    <div id="M002791_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/text.rb, line 301</span>
301:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xpath</span>
302:       <span class="ruby-identifier">path</span> = <span class="ruby-ivar">@parent</span>.<span class="ruby-identifier">xpath</span>
303:       <span class="ruby-identifier">path</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot;/text()&quot;</span>
304:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span>
305:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    