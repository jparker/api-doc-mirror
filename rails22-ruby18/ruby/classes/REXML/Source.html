<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>REXML::Source</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            REXML::Source 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rexml/source_rb.html">lib/rexml/source.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    
    <div class="description">
        <p>
A <a href="Source.html">Source</a> can be searched for patterns, and wraps
buffers and other objects and provides consumption of text
</p>

    </div>
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M002010">consume</a>,</li>
                
                <li><a href="#M002016">current_line</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M002014">empty?</a>,</li>
                
                <li><a href="#M002007">encoding=</a></li>
                
            </ul>
        </dd>
    
        <dt>M</dt>
        <dd>
            <ul>
                
                <li><a href="#M002013">match</a>,</li>
                
                <li><a href="#M002011">match_to</a>,</li>
                
                <li><a href="#M002012">match_to_consume</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M002006">new</a></li>
                
            </ul>
        </dd>
    
        <dt>P</dt>
        <dd>
            <ul>
                
                <li><a href="#M002015">position</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M002009">read</a></li>
                
            </ul>
        </dd>
    
        <dt>S</dt>
        <dd>
            <ul>
                
                <li><a href="#M002008">scan</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../REXML.html">REXML</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>buffer</td>
            <td class='attr-desc'><p>
The current buffer (what we&#8217;re going to read next)
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>line</td>
            <td class='attr-desc'><p>
The line number of the last consumed text
</p></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>encoding</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M002006">
                    
                    <a name="M002006"></a><b>new</b>(arg, encoding=nil)
                    
                </div>
                
                <div class="description">
                  <p>
Constructor @param arg must be a <a href="../String.html">String</a>, and
should be a valid XML document @param encoding if non-null, sets the
encoding of the source to this value, overriding all encoding detection
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002006_source')" id="l_M002006_source">show</a>
                        
                    </p>
                    <div id="M002006_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 40</span>
40:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">encoding</span>=<span class="ruby-keyword kw">nil</span>)
41:       <span class="ruby-ivar">@orig</span> = <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">arg</span>
42:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">encoding</span>
43:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">encoding</span>
44:       <span class="ruby-keyword kw">else</span>
45:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">check_encoding</span>( <span class="ruby-ivar">@buffer</span> )
46:       <span class="ruby-keyword kw">end</span>
47:       <span class="ruby-ivar">@line</span> = <span class="ruby-value">0</span>
48:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M002010">
                    
                    <a name="M002010"></a><b>consume</b>( pattern )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002010_source')" id="l_M002010_source">show</a>
                        
                    </p>
                    <div id="M002010_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 90</span>
90:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">consume</span>( <span class="ruby-identifier">pattern</span> )
91:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>( <span class="ruby-ivar">@buffer</span> )
92:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002016">
                    
                    <a name="M002016"></a><b>current_line</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return the current line in the source
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002016_source')" id="l_M002016_source">show</a>
                        
                    </p>
                    <div id="M002016_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 120</span>
120:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_line</span>
121:       <span class="ruby-identifier">lines</span> = <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">split</span>
122:       <span class="ruby-identifier">res</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">grep</span> <span class="ruby-ivar">@buffer</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">30</span>]
123:       <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>[<span class="ruby-value">-1</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
124:       <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">index</span>( <span class="ruby-identifier">res</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>
125:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002014">
                    
                    <a name="M002014"></a><b>empty?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
@return true if the <a href="Source.html">Source</a> is exhausted
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002014_source')" id="l_M002014_source">show</a>
                        
                    </p>
                    <div id="M002014_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 111</span>
111:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
112:       <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
113:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002007">
                    
                    <a name="M002007"></a><b>encoding=</b>(enc)
                    
                </div>
                
                <div class="description">
                  <p>
Inherited from <a href="Encoding.html">Encoding</a> Overridden to support
optimized en/decoding
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002007_source')" id="l_M002007_source">show</a>
                        
                    </p>
                    <div id="M002007_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 53</span>
53:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoding=</span>(<span class="ruby-identifier">enc</span>)
54:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">super</span>
55:       <span class="ruby-ivar">@line_break</span> = <span class="ruby-identifier">encode</span>( <span class="ruby-value str">'&gt;'</span> )
56:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">enc</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">UTF_8</span>
57:         <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">decode</span>(<span class="ruby-ivar">@buffer</span>)
58:         <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">true</span>
59:       <span class="ruby-keyword kw">else</span>
60:         <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">false</span>
61:       <span class="ruby-keyword kw">end</span>
62:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002013">
                    
                    <a name="M002013"></a><b>match</b>(pattern, cons=false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002013_source')" id="l_M002013_source">show</a>
                        
                    </p>
                    <div id="M002013_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 104</span>
104:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
105:       <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
106:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">md</span>
107:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
108:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002011">
                    
                    <a name="M002011"></a><b>match_to</b>( char, pattern )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002011_source')" id="l_M002011_source">show</a>
                        
                    </p>
                    <div id="M002011_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 94</span>
94:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
95:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
96:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002012">
                    
                    <a name="M002012"></a><b>match_to_consume</b>( char, pattern )
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002012_source')" id="l_M002012_source">show</a>
                        
                    </p>
                    <div id="M002012_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 98</span>
 98:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to_consume</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
 99:       <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
100:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span>
101:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
102:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002015">
                    
                    <a name="M002015"></a><b>position</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002015_source')" id="l_M002015_source">show</a>
                        
                    </p>
                    <div id="M002015_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 115</span>
115:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">position</span>
116:       <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">index</span>( <span class="ruby-ivar">@buffer</span> )
117:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002009">
                    
                    <a name="M002009"></a><b>read</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002009_source')" id="l_M002009_source">show</a>
                        
                    </p>
                    <div id="M002009_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 87</span>
87:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>
88:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M002008">
                    
                    <a name="M002008"></a><b>scan</b>(pattern, cons=false)
                    
                </div>
                
                <div class="description">
                  <p>
Scans the source for a given pattern. Note, that this is not your usual
scan() method. For one thing, the pattern argument has some requirements;
for another, the source can be consumed. You can easily confuse this
method. Originally, the patterns were easier to construct and this method
more robust, because this method generated search regexes on the fly;
however, this was computationally expensive and slowed down the entire <a
href="../REXML.html">REXML</a> package considerably, since this is by far
the most commonly called method. @param pattern must be a <a
href="../Regexp.html">Regexp</a>, and must be in the form of /^s*(#{your
pattern, with no groups})(.*)/. The first group will be returned; the
second group is used if the consume flag is set. @param consume if true,
the pattern returned will be consumed, leaving everything after it in the
<a href="Source.html">Source</a>. @return the pattern, if found, or nil if
the <a href="Source.html">Source</a> is empty or the pattern is not found.
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M002008_source')" id="l_M002008_source">show</a>
                        
                    </p>
                    <div id="M002008_source" class="dyn-source">
                        <pre>    <span class="ruby-comment cmt"># File lib/rexml/source.rb, line 80</span>
80:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
81:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">nil?</span>
82:       <span class="ruby-identifier">rv</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>)
83:       <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
84:       <span class="ruby-identifier">rv</span>
85:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    