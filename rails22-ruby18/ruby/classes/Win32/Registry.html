<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Win32::Registry</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
    <script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Class</span> 
            Win32::Registry 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/ext/Win32API/lib/win32/registry_rb.html">ext/Win32API/lib/win32/registry.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>#</dt>
        <dd>
            <ul>
                
                <li><a href="#M007619">[]</a>,</li>
                
                <li><a href="#M007625">[]=</a>,</li>
                
                <li><a href="#M007610">_dump</a></li>
                
            </ul>
        </dd>
    
        <dt>C</dt>
        <dd>
            <ul>
                
                <li><a href="#M007613">close</a>,</li>
                
                <li><a href="#M007604">create</a>,</li>
                
                <li><a href="#M007612">create</a>,</li>
                
                <li><a href="#M007606">created?</a></li>
                
            </ul>
        </dd>
    
        <dt>D</dt>
        <dd>
            <ul>
                
                <li><a href="#M007630">delete</a>,</li>
                
                <li><a href="#M007631">delete_key</a>,</li>
                
                <li><a href="#M007629">delete_value</a></li>
                
            </ul>
        </dd>
    
        <dt>E</dt>
        <dd>
            <ul>
                
                <li><a href="#M007615">each</a>,</li>
                
                <li><a href="#M007616">each_key</a>,</li>
                
                <li><a href="#M007614">each_value</a>,</li>
                
                <li><a href="#M007599">expand_environ</a></li>
                
            </ul>
        </dd>
    
        <dt>F</dt>
        <dd>
            <ul>
                
                <li><a href="#M007632">flush</a></li>
                
            </ul>
        </dd>
    
        <dt>I</dt>
        <dd>
            <ul>
                
                <li><a href="#M007633">info</a>,</li>
                
                <li><a href="#M007609">inspect</a></li>
                
            </ul>
        </dd>
    
        <dt>K</dt>
        <dd>
            <ul>
                
                <li><a href="#M007617">keys</a></li>
                
            </ul>
        </dd>
    
        <dt>N</dt>
        <dd>
            <ul>
                
                <li><a href="#M007608">name</a>,</li>
                
                <li><a href="#M007605">new</a></li>
                
            </ul>
        </dd>
    
        <dt>O</dt>
        <dd>
            <ul>
                
                <li><a href="#M007611">open</a>,</li>
                
                <li><a href="#M007603">open</a>,</li>
                
                <li><a href="#M007607">open?</a></li>
                
            </ul>
        </dd>
    
        <dt>R</dt>
        <dd>
            <ul>
                
                <li><a href="#M007618">read</a>,</li>
                
                <li><a href="#M007623">read_bin</a>,</li>
                
                <li><a href="#M007622">read_i</a>,</li>
                
                <li><a href="#M007620">read_s</a>,</li>
                
                <li><a href="#M007621">read_s_expand</a></li>
                
            </ul>
        </dd>
    
        <dt>T</dt>
        <dd>
            <ul>
                
                <li><a href="#M007602">time2wtime</a>,</li>
                
                <li><a href="#M007600">type2name</a></li>
                
            </ul>
        </dd>
    
        <dt>W</dt>
        <dd>
            <ul>
                
                <li><a href="#M007624">write</a>,</li>
                
                <li><a href="#M007628">write_bin</a>,</li>
                
                <li><a href="#M007627">write_i</a>,</li>
                
                <li><a href="#M007626">write_s</a>,</li>
                
                <li><a href="#M007601">wtime2time</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../File/Constants.html">File::Constants</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="../Marshal.html">Marshal</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Classes and Modules</div>
    <ul>
        
        <li><span class="type">MODULE</span> <a href="Registry/API.html">Win32::Registry::API</a></li>
        
        <li><span class="type">MODULE</span> <a href="Registry/Constants.html">Win32::Registry::Constants</a></li>
        
        <li><span class="type">CLASS</span> <a href="Registry/Error.html">Win32::Registry::Error</a></li>
        
        <li><span class="type">CLASS</span> <a href="Registry/PredefinedKey.html">Win32::Registry::PredefinedKey</a></li>
        
    </ul>
    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>hkey</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>parent</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>keyname</td>
            <td class='attr-desc'></td>
        </tr>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [R]
            </td>
            <td class='attr-name'>disposition</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Class Public methods</div>
            
            <div class="method">
                <div class="title" id="M007604">
                    
                    <a name="M007604"></a><b>create</b>(hkey, subkey, desired = KEY_ALL_ACCESS, opt = REG_OPTION_RESERVED)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007604_source')" id="l_M007604_source">show</a>
                        
                    </p>
                    <div id="M007604_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 541</span>
541:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span> = <span class="ruby-constant">KEY_ALL_ACCESS</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-constant">REG_OPTION_RESERVED</span>)
542:       <span class="ruby-identifier">newkey</span>, <span class="ruby-identifier">disp</span> = <span class="ruby-constant">API</span>.<span class="ruby-constant">CreateKey</span>(<span class="ruby-identifier">hkey</span>.<span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-identifier">desired</span>)
543:       <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">newkey</span>, <span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">disp</span>)
544:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
545:         <span class="ruby-keyword kw">begin</span>
546:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">obj</span>
547:         <span class="ruby-keyword kw">ensure</span>
548:           <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">close</span>
549:         <span class="ruby-keyword kw">end</span>
550:       <span class="ruby-keyword kw">else</span>
551:         <span class="ruby-identifier">obj</span>
552:       <span class="ruby-keyword kw">end</span>
553:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007599">
                    
                    <a name="M007599"></a><b>expand_environ</b>(str)
                    
                </div>
                
                <div class="description">
                  <p>
utility functions
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007599_source')" id="l_M007599_source">show</a>
                        
                    </p>
                    <div id="M007599_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 495</span>
495:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">expand_environ</span>(<span class="ruby-identifier">str</span>)
496:       <span class="ruby-identifier">str</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/%([^%]+)%/</span>) { <span class="ruby-constant">ENV</span>[<span class="ruby-identifier">$1</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-identifier">$1</span>.<span class="ruby-identifier">upcase</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">$&amp;</span> }
497:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007605">
                    
                    <a name="M007605"></a><b>new</b>(hkey, parent, keyname, disposition)
                    
                </div>
                
                <div class="description">
                  <p>
initialize
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007605_source')" id="l_M007605_source">show</a>
                        
                    </p>
                    <div id="M007605_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 563</span>
563:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">parent</span>, <span class="ruby-identifier">keyname</span>, <span class="ruby-identifier">disposition</span>)
564:       <span class="ruby-ivar">@hkey</span> = <span class="ruby-identifier">hkey</span>
565:       <span class="ruby-ivar">@parent</span> = <span class="ruby-identifier">parent</span>
566:       <span class="ruby-ivar">@keyname</span> = <span class="ruby-identifier">keyname</span>
567:       <span class="ruby-ivar">@disposition</span> = <span class="ruby-identifier">disposition</span>
568:       <span class="ruby-ivar">@hkeyfinal</span> = [ <span class="ruby-identifier">hkey</span> ]
569:       <span class="ruby-constant">ObjectSpace</span>.<span class="ruby-identifier">define_finalizer</span> <span class="ruby-keyword kw">self</span>, <span class="ruby-ivar">@@final</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@hkeyfinal</span>)
570:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007603">
                    
                    <a name="M007603"></a><b>open</b>(hkey, subkey, desired = KEY_READ, opt = REG_OPTION_RESERVED)
                    
                </div>
                
                <div class="description">
                  <p>
constructors
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007603_source')" id="l_M007603_source">show</a>
                        
                    </p>
                    <div id="M007603_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 526</span>
526:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span> = <span class="ruby-constant">KEY_READ</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-constant">REG_OPTION_RESERVED</span>)
527:       <span class="ruby-identifier">subkey</span> = <span class="ruby-identifier">subkey</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">'\\'</span>)
528:       <span class="ruby-identifier">newkey</span> = <span class="ruby-constant">API</span>.<span class="ruby-constant">OpenKey</span>(<span class="ruby-identifier">hkey</span>.<span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-identifier">desired</span>)
529:       <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">newkey</span>, <span class="ruby-identifier">hkey</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-constant">REG_OPENED_EXISTING_KEY</span>)
530:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
531:         <span class="ruby-keyword kw">begin</span>
532:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">obj</span>
533:         <span class="ruby-keyword kw">ensure</span>
534:           <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">close</span>
535:         <span class="ruby-keyword kw">end</span>
536:       <span class="ruby-keyword kw">else</span>
537:         <span class="ruby-identifier">obj</span>
538:       <span class="ruby-keyword kw">end</span>
539:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007602">
                    
                    <a name="M007602"></a><b>time2wtime</b>(time)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007602_source')" id="l_M007602_source">show</a>
                        
                    </p>
                    <div id="M007602_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 517</span>
517:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">time2wtime</span>(<span class="ruby-identifier">time</span>)
518:       <span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">*</span> <span class="ruby-value">10000000</span> <span class="ruby-operator">+</span> <span class="ruby-value">116444736000000000</span>
519:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007600">
                    
                    <a name="M007600"></a><b>type2name</b>(type)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007600_source')" id="l_M007600_source">show</a>
                        
                    </p>
                    <div id="M007600_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 509</span>
509:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">type2name</span>(<span class="ruby-identifier">type</span>)
510:       <span class="ruby-ivar">@@type2name</span>[<span class="ruby-identifier">type</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>
511:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007601">
                    
                    <a name="M007601"></a><b>wtime2time</b>(wtime)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007601_source')" id="l_M007601_source">show</a>
                        
                    </p>
                    <div id="M007601_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 513</span>
513:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">wtime2time</span>(<span class="ruby-identifier">wtime</span>)
514:       <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>((<span class="ruby-identifier">wtime</span> <span class="ruby-operator">-</span> <span class="ruby-value">116444736000000000</span>) <span class="ruby-operator">/</span> <span class="ruby-value">10000000</span>)
515:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M007619">
                    
                    <a name="M007619"></a><b>[]</b>(name, *rtype)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007619_source')" id="l_M007619_source">show</a>
                        
                    </p>
                    <div id="M007619_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 690</span>
690:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rtype</span>)
691:       <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span> = <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rtype</span>)
692:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>
693:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_SZ</span>, <span class="ruby-constant">REG_DWORD</span>, <span class="ruby-constant">REG_QWORD</span>, <span class="ruby-constant">REG_MULTI_SZ</span>
694:         <span class="ruby-identifier">data</span>
695:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_EXPAND_SZ</span>
696:         <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">expand_environ</span>(<span class="ruby-identifier">data</span>)
697:       <span class="ruby-keyword kw">else</span>
698:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Type #{type} is not supported.&quot;</span>
699:       <span class="ruby-keyword kw">end</span>
700:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007625">
                    
                    <a name="M007625"></a><b>[]=</b>(name, rtype, value = nil)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007625_source')" id="l_M007625_source">show</a>
                        
                    </p>
                    <div id="M007625_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 746</span>
746:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">rtype</span>, <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">nil</span>)
747:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>
748:         <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">rtype</span>, <span class="ruby-identifier">value</span>
749:       <span class="ruby-keyword kw">else</span>
750:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span> = <span class="ruby-identifier">rtype</span>
751:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Integer</span>
752:           <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_DWORD</span>, <span class="ruby-identifier">value</span>
753:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
754:           <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_SZ</span>, <span class="ruby-identifier">value</span>
755:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>
756:           <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_MULTI_SZ</span>, <span class="ruby-identifier">value</span>
757:         <span class="ruby-keyword kw">else</span>
758:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Unexpected type #{value.class}&quot;</span>
759:         <span class="ruby-keyword kw">end</span>
760:       <span class="ruby-keyword kw">end</span>
761:       <span class="ruby-identifier">value</span>
762:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007610">
                    
                    <a name="M007610"></a><b>_dump</b>(depth)
                    
                </div>
                
                <div class="description">
                  <p>
marshalling
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007610_source')" id="l_M007610_source">show</a>
                        
                    </p>
                    <div id="M007610_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 600</span>
600:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">_dump</span>(<span class="ruby-identifier">depth</span>)
601:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-value str">&quot;can't dump Win32::Registry&quot;</span>
602:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007613">
                    
                    <a name="M007613"></a><b>close</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007613_source')" id="l_M007613_source">show</a>
                        
                    </p>
                    <div id="M007613_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 615</span>
615:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">close</span>
616:       <span class="ruby-constant">API</span>.<span class="ruby-constant">CloseKey</span>(<span class="ruby-ivar">@hkey</span>)
617:       <span class="ruby-ivar">@hkey</span> = <span class="ruby-ivar">@parent</span> = <span class="ruby-ivar">@keyname</span> = <span class="ruby-keyword kw">nil</span>
618:       <span class="ruby-ivar">@hkeyfinal</span>[<span class="ruby-value">0</span>] = <span class="ruby-keyword kw">nil</span>
619:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007612">
                    
                    <a name="M007612"></a><b>create</b>(subkey, desired = KEY_ALL_ACCESS, opt = REG_OPTION_RESERVED, &amp;blk)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007612_source')" id="l_M007612_source">show</a>
                        
                    </p>
                    <div id="M007612_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 611</span>
611:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span> = <span class="ruby-constant">KEY_ALL_ACCESS</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-constant">REG_OPTION_RESERVED</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
612:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">create</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
613:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007606">
                    
                    <a name="M007606"></a><b>created?</b>()
                    
                </div>
                
                <div class="description">
                  <p>
attributes
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007606_source')" id="l_M007606_source">show</a>
                        
                    </p>
                    <div id="M007606_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 576</span>
576:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">created?</span>
577:       <span class="ruby-ivar">@disposition</span> <span class="ruby-operator">==</span> <span class="ruby-constant">REG_CREATED_NEW_KEY</span>
578:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007630">
                    
                    <a name="M007630"></a><b>delete</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Registry.html#M007629">delete_value</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M007631">
                    
                    <a name="M007631"></a><b>delete_key</b>(name, recursive = false)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007631_source')" id="l_M007631_source">show</a>
                        
                    </p>
                    <div id="M007631_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 784</span>
784:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">recursive</span> = <span class="ruby-keyword kw">false</span>)
785:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">recursive</span>
786:         <span class="ruby-identifier">open</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">KEY_ALL_ACCESS</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">reg</span><span class="ruby-operator">|</span>
787:           <span class="ruby-identifier">reg</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
788:             <span class="ruby-keyword kw">begin</span>
789:               <span class="ruby-identifier">reg</span>.<span class="ruby-identifier">delete_key</span>(<span class="ruby-identifier">key</span>, <span class="ruby-keyword kw">true</span>)
790:             <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Error</span>
791:               <span class="ruby-comment cmt">#</span>
792:             <span class="ruby-keyword kw">end</span>
793:           <span class="ruby-keyword kw">end</span>
794:         <span class="ruby-keyword kw">end</span>
795:         <span class="ruby-constant">API</span>.<span class="ruby-constant">DeleteKey</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">name</span>)
796:       <span class="ruby-keyword kw">else</span>
797:         <span class="ruby-keyword kw">begin</span>
798:           <span class="ruby-constant">API</span>.<span class="ruby-constant">EnumKey</span> <span class="ruby-ivar">@hkey</span>, <span class="ruby-value">0</span>
799:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Error</span>
800:           <span class="ruby-keyword kw">return</span> <span class="ruby-constant">API</span>.<span class="ruby-constant">DeleteKey</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">name</span>)
801:         <span class="ruby-keyword kw">end</span>
802:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">5</span>) <span class="ruby-comment cmt">## ERROR_ACCESS_DENIED</span>
803:       <span class="ruby-keyword kw">end</span>
804:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007629">
                    
                    <a name="M007629"></a><b>delete_value</b>(name)
                    
                </div>
                
                <div class="description">
                  <p>
delete
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Registry.html#M007630">delete</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007629_source')" id="l_M007629_source">show</a>
                        
                    </p>
                    <div id="M007629_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 779</span>
779:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_value</span>(<span class="ruby-identifier">name</span>)
780:       <span class="ruby-constant">API</span>.<span class="ruby-constant">DeleteValue</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">name</span>)
781:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007615">
                    
                    <a name="M007615"></a><b>each</b>()
                    
                </div>
                
                <div class="description">
                  <p>
Alias for <a href="Registry.html#M007614">each_value</a>
</p>

                </div>
                
                
                
            </div>
            
            <div class="method">
                <div class="title" id="M007616">
                    
                    <a name="M007616"></a><b>each_key</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007616_source')" id="l_M007616_source">show</a>
                        
                    </p>
                    <div id="M007616_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 644</span>
644:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_key</span>
645:       <span class="ruby-identifier">index</span> = <span class="ruby-value">0</span>
646:       <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
647:         <span class="ruby-keyword kw">begin</span>
648:           <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">wtime</span> = <span class="ruby-constant">API</span>.<span class="ruby-constant">EnumKey</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">index</span>)
649:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Error</span>
650:           <span class="ruby-keyword kw">break</span>
651:         <span class="ruby-keyword kw">end</span>
652:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">wtime</span>
653:         <span class="ruby-identifier">index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
654:       <span class="ruby-keyword kw">end</span>
655:       <span class="ruby-identifier">index</span>
656:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007614">
                    
                    <a name="M007614"></a><b>each_value</b>()
                    
                </div>
                
                <div class="description">
                  <p>
iterator
</p>

                </div>
                
                
                <div class="aka">
                    This method is also aliased as
                    
                    <a href="Registry.html#M007615">each</a>
                    
                </div>
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007614_source')" id="l_M007614_source">show</a>
                        
                    </p>
                    <div id="M007614_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 624</span>
624:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_value</span>
625:       <span class="ruby-identifier">index</span> = <span class="ruby-value">0</span>
626:       <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
627:         <span class="ruby-keyword kw">begin</span>
628:           <span class="ruby-identifier">subkey</span> = <span class="ruby-constant">API</span>.<span class="ruby-constant">EnumValue</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">index</span>)
629:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Error</span>
630:           <span class="ruby-keyword kw">break</span>
631:         <span class="ruby-keyword kw">end</span>
632:         <span class="ruby-keyword kw">begin</span>
633:           <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span> = <span class="ruby-identifier">read</span>(<span class="ruby-identifier">subkey</span>)
634:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Error</span>
635:           <span class="ruby-keyword kw">next</span>
636:         <span class="ruby-keyword kw">end</span>
637:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>
638:         <span class="ruby-identifier">index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
639:       <span class="ruby-keyword kw">end</span>
640:       <span class="ruby-identifier">index</span>
641:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007632">
                    
                    <a name="M007632"></a><b>flush</b>()
                    
                </div>
                
                <div class="description">
                  <p>
flush
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007632_source')" id="l_M007632_source">show</a>
                        
                    </p>
                    <div id="M007632_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 809</span>
809:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush</span>
810:       <span class="ruby-constant">API</span>.<span class="ruby-constant">FlushKey</span> <span class="ruby-ivar">@hkey</span>
811:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007633">
                    
                    <a name="M007633"></a><b>info</b>()
                    
                </div>
                
                <div class="description">
                  <p>
key information
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007633_source')" id="l_M007633_source">show</a>
                        
                    </p>
                    <div id="M007633_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 816</span>
816:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info</span>
817:       <span class="ruby-constant">API</span>.<span class="ruby-constant">QueryInfoKey</span>(<span class="ruby-ivar">@hkey</span>)
818:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007609">
                    
                    <a name="M007609"></a><b>inspect</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007609_source')" id="l_M007609_source">show</a>
                        
                    </p>
                    <div id="M007609_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 593</span>
593:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
594:       <span class="ruby-node">&quot;\#&lt;Win32::Registry key=#{name.inspect}&gt;&quot;</span>
595:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007617">
                    
                    <a name="M007617"></a><b>keys</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007617_source')" id="l_M007617_source">show</a>
                        
                    </p>
                    <div id="M007617_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 658</span>
658:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">keys</span>
659:       <span class="ruby-identifier">keys_ary</span> = []
660:       <span class="ruby-identifier">each_key</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>,<span class="ruby-operator">|</span> <span class="ruby-identifier">keys_ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">key</span> }
661:       <span class="ruby-identifier">keys_ary</span>
662:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007608">
                    
                    <a name="M007608"></a><b>name</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007608_source')" id="l_M007608_source">show</a>
                        
                    </p>
                    <div id="M007608_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 584</span>
584:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">name</span>
585:       <span class="ruby-identifier">parent</span> = <span class="ruby-keyword kw">self</span>
586:       <span class="ruby-identifier">name</span> = <span class="ruby-ivar">@keyname</span>
587:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">parent</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">parent</span>
588:         <span class="ruby-identifier">name</span> = <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">keyname</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'\\'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">name</span>
589:       <span class="ruby-keyword kw">end</span>
590:       <span class="ruby-identifier">name</span>
591:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007611">
                    
                    <a name="M007611"></a><b>open</b>(subkey, desired = KEY_READ, opt = REG_OPTION_RESERVED, &amp;blk)
                    
                </div>
                
                <div class="description">
                  <p>
open/close
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007611_source')" id="l_M007611_source">show</a>
                        
                    </p>
                    <div id="M007611_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 607</span>
607:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open</span>(<span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span> = <span class="ruby-constant">KEY_READ</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-constant">REG_OPTION_RESERVED</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
608:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">open</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">subkey</span>, <span class="ruby-identifier">desired</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">blk</span>)
609:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007607">
                    
                    <a name="M007607"></a><b>open?</b>()
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007607_source')" id="l_M007607_source">show</a>
                        
                    </p>
                    <div id="M007607_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 580</span>
580:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open?</span>
581:       <span class="ruby-operator">!</span><span class="ruby-ivar">@hkey</span>.<span class="ruby-identifier">nil?</span>
582:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007618">
                    
                    <a name="M007618"></a><b>read</b>(name, *rtype)
                    
                </div>
                
                <div class="description">
                  <p>
reader
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007618_source')" id="l_M007618_source">show</a>
                        
                    </p>
                    <div id="M007618_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 667</span>
667:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">rtype</span>)
668:       <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span> = <span class="ruby-constant">API</span>.<span class="ruby-constant">QueryValue</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">name</span>)
669:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">rtype</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">rtype</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">type</span>)
670:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Type mismatch (expect #{rtype.inspect} but #{type} present)&quot;</span>
671:       <span class="ruby-keyword kw">end</span>
672:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>
673:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_SZ</span>, <span class="ruby-constant">REG_EXPAND_SZ</span>
674:         [ <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">chop</span> ]
675:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_MULTI_SZ</span>
676:         [ <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\0/</span>) ]
677:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_BINARY</span>
678:         [ <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span> ]
679:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_DWORD</span>
680:         [ <span class="ruby-identifier">type</span>, <span class="ruby-constant">API</span>.<span class="ruby-identifier">unpackdw</span>(<span class="ruby-identifier">data</span>) ]
681:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_DWORD_BIG_ENDIAN</span>
682:         [ <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'N'</span>)[<span class="ruby-value">0</span>] ]
683:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_QWORD</span>
684:         [ <span class="ruby-identifier">type</span>, <span class="ruby-constant">API</span>.<span class="ruby-identifier">unpackqw</span>(<span class="ruby-identifier">data</span>) ]
685:       <span class="ruby-keyword kw">else</span>
686:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Type #{type} is not supported.&quot;</span>
687:       <span class="ruby-keyword kw">end</span>
688:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007623">
                    
                    <a name="M007623"></a><b>read_bin</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007623_source')" id="l_M007623_source">show</a>
                        
                    </p>
                    <div id="M007623_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 719</span>
719:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_bin</span>(<span class="ruby-identifier">name</span>)
720:       <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_BINARY</span>)[<span class="ruby-value">1</span>]
721:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007622">
                    
                    <a name="M007622"></a><b>read_i</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007622_source')" id="l_M007622_source">show</a>
                        
                    </p>
                    <div id="M007622_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 715</span>
715:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_i</span>(<span class="ruby-identifier">name</span>)
716:       <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_DWORD</span>, <span class="ruby-constant">REG_DWORD_BIG_ENDIAN</span>, <span class="ruby-constant">REG_QWORD</span>)[<span class="ruby-value">1</span>]
717:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007620">
                    
                    <a name="M007620"></a><b>read_s</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007620_source')" id="l_M007620_source">show</a>
                        
                    </p>
                    <div id="M007620_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 702</span>
702:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_s</span>(<span class="ruby-identifier">name</span>)
703:       <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_SZ</span>)[<span class="ruby-value">1</span>]
704:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007621">
                    
                    <a name="M007621"></a><b>read_s_expand</b>(name)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007621_source')" id="l_M007621_source">show</a>
                        
                    </p>
                    <div id="M007621_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 706</span>
706:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_s_expand</span>(<span class="ruby-identifier">name</span>)
707:       <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span> = <span class="ruby-identifier">read</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_SZ</span>, <span class="ruby-constant">REG_EXPAND_SZ</span>)
708:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-constant">REG_EXPAND_SZ</span>
709:         <span class="ruby-constant">Registry</span>.<span class="ruby-identifier">expand_environ</span>(<span class="ruby-identifier">data</span>)
710:       <span class="ruby-keyword kw">else</span>
711:         <span class="ruby-identifier">data</span>
712:       <span class="ruby-keyword kw">end</span>
713:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007624">
                    
                    <a name="M007624"></a><b>write</b>(name, type, data)
                    
                </div>
                
                <div class="description">
                  <p>
writer
</p>

                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007624_source')" id="l_M007624_source">show</a>
                        
                    </p>
                    <div id="M007624_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 726</span>
726:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>)
727:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>
728:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_SZ</span>, <span class="ruby-constant">REG_EXPAND_SZ</span>
729:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\0&quot;</span>
730:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_MULTI_SZ</span>
731:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\0&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\0\0&quot;</span>
732:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_BINARY</span>
733:         <span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_s</span>
734:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_DWORD</span>
735:         <span class="ruby-identifier">data</span> = <span class="ruby-constant">API</span>.<span class="ruby-identifier">packdw</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_i</span>)
736:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_DWORD_BIG_ENDIAN</span>
737:         <span class="ruby-identifier">data</span> = [<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_i</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-value str">'N'</span>)
738:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">REG_QWORD</span>
739:         <span class="ruby-identifier">data</span> = <span class="ruby-constant">API</span>.<span class="ruby-identifier">packqw</span>(<span class="ruby-identifier">data</span>.<span class="ruby-identifier">to_i</span>)
740:       <span class="ruby-keyword kw">else</span>
741:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Unsupported type #{type}&quot;</span>
742:       <span class="ruby-keyword kw">end</span>
743:       <span class="ruby-constant">API</span>.<span class="ruby-constant">SetValue</span>(<span class="ruby-ivar">@hkey</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">data</span>.<span class="ruby-identifier">length</span>)
744:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007628">
                    
                    <a name="M007628"></a><b>write_bin</b>(name, value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007628_source')" id="l_M007628_source">show</a>
                        
                    </p>
                    <div id="M007628_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 772</span>
772:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_bin</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
773:       <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_BINARY</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
774:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007627">
                    
                    <a name="M007627"></a><b>write_i</b>(name, value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007627_source')" id="l_M007627_source">show</a>
                        
                    </p>
                    <div id="M007627_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 768</span>
768:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_i</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
769:       <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_DWORD</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_i</span>
770:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
            <div class="method">
                <div class="title" id="M007626">
                    
                    <a name="M007626"></a><b>write_s</b>(name, value)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M007626_source')" id="l_M007626_source">show</a>
                        
                    </p>
                    <div id="M007626_source" class="dyn-source">
                        <pre>     <span class="ruby-comment cmt"># File ext/Win32API/lib/win32/registry.rb, line 764</span>
764:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write_s</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
765:       <span class="ruby-identifier">write</span> <span class="ruby-identifier">name</span>, <span class="ruby-constant">REG_SZ</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
766:     <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    